<!DOCTYPE html>
<html lang="ar" dir="ltr">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
    <title>Magical Hijaiyah Cube ‚ú® - ŸÖŸÉÿπÿ® ÿßŸÑÿ≠ÿ±ŸàŸÅ ÿßŸÑŸáÿ¨ÿßÿ¶Ÿäÿ©</title>
    <meta name="description" content="An interactive 3D educational game to learn Hijaiyah letters for toddlers." />
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;700;800&display=swap');

        *,
        *::before,
        *::after {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --pink-soft: #f8c8dc;
            --lavender: #d8b4fe;
            --mint: #a7f3d0;
            --sky: #93c5fd;
            --peach: #fed7aa;
            --yellow-soft: #fde68a;
            --bg-gradient: linear-gradient(135deg, #fdf2f8 0%, #ede9fe 50%, #e0f2fe 100%);
            --btn-gradient: linear-gradient(135deg, #f472b6, #c084fc, #60a5fa);
            --glow-pink: 0 0 30px rgba(244, 114, 182, 0.4);
            --glow-purple: 0 0 30px rgba(192, 132, 252, 0.4);
            --font-main: 'Outfit', sans-serif;
        }

        html,
        body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            font-family: var(--font-main);
            background: var(--bg-gradient);
        }

        /* ===== LOADING SCREEN ===== */
        #loading-screen {
            position: fixed;
            inset: 0;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: var(--bg-gradient);
            transition: opacity 0.8s ease, visibility 0.8s ease;
        }

        #loading-screen.hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }

        .loading-title {
            font-size: clamp(1.8rem, 5vw, 3rem);
            font-weight: 800;
            background: var(--btn-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 2rem;
            text-align: center;
            padding: 0 1rem;
        }

        .loading-cube {
            width: 60px;
            height: 60px;
            background: var(--btn-gradient);
            border-radius: 14px;
            animation: loading-spin 1.2s ease-in-out infinite;
            margin-bottom: 2rem;
        }

        @keyframes loading-spin {
            0% {
                transform: rotate(0deg) scale(1);
            }

            50% {
                transform: rotate(180deg) scale(0.8);
            }

            100% {
                transform: rotate(360deg) scale(1);
            }
        }

        .loading-bar-container {
            width: min(280px, 70vw);
            height: 14px;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 999px;
            overflow: hidden;
            box-shadow: inset 0 2px 6px rgba(0, 0, 0, 0.06);
        }

        .loading-bar-fill {
            height: 100%;
            width: 0%;
            background: var(--btn-gradient);
            border-radius: 999px;
            transition: width 0.3s ease;
        }

        /* ===== CANVAS ===== */
        #game-canvas {
            display: block;
            width: 100%;
            height: 100%;
        }

        /* ===== UI OVERLAY ===== */
        #ui-overlay {
            position: fixed;
            inset: 0;
            pointer-events: none;
            z-index: 10;
            opacity: 0;
            transition: opacity 0.6s ease;
        }

        #ui-overlay.visible {
            opacity: 1;
        }

        /* Header */
        .header {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            padding: clamp(12px, 3vw, 24px);
            text-align: center;
        }

        .header h1 {
            font-size: clamp(1.2rem, 4vw, 2rem);
            font-weight: 800;
            color: #7c3aed;
            text-shadow: 0 2px 8px rgba(124, 58, 237, 0.15);
        }

        /* Letter Display */
        #letter-display {
            position: absolute;
            top: clamp(56px, 10vw, 90px);
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            opacity: 0;
            transition: opacity 0.4s ease, transform 0.4s ease;
        }

        #letter-display.show {
            opacity: 1;
        }

        .letter-name {
            font-size: clamp(1.6rem, 5vw, 2.8rem);
            font-weight: 800;
            color: #ec4899;
            text-shadow: 0 2px 10px rgba(236, 72, 153, 0.25);
            animation: letter-pop 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .letter-arabic {
            font-size: clamp(2.4rem, 7vw, 4rem);
            font-weight: 700;
            color: #7c3aed;
            line-height: 1;
        }

        @keyframes letter-pop {
            0% {
                transform: scale(0);
            }

            100% {
                transform: scale(1);
            }
        }

        /* Buttons */
        .btn-container {
            position: absolute;
            bottom: clamp(20px, 5vw, 40px);
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: clamp(12px, 3vw, 20px);
            pointer-events: auto;
        }

        .btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: clamp(14px, 3vw, 20px) clamp(24px, 5vw, 40px);
            font-family: var(--font-main);
            font-size: clamp(1rem, 3vw, 1.3rem);
            font-weight: 700;
            color: #fff;
            border: none;
            border-radius: 999px;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
            user-select: none;
        }

        .btn-next {
            background: var(--btn-gradient);
            box-shadow: var(--glow-pink), 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .btn-next:hover {
            transform: scale(1.08);
            box-shadow: var(--glow-purple), 0 6px 20px rgba(0, 0, 0, 0.15);
        }

        .btn-next:active {
            transform: scale(0.96);
        }

        .btn-tap {
            background: linear-gradient(135deg, #34d399, #22d3ee);
            box-shadow: 0 0 25px rgba(52, 211, 153, 0.35), 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .btn-tap:hover {
            transform: scale(1.08);
        }

        .btn-tap:active {
            transform: scale(0.96);
        }

        /* Emoji in button */
        .btn-emoji {
            font-size: 1.4em;
            line-height: 1;
        }

        /* Floating decorations */
        .floating-star {
            position: fixed;
            font-size: clamp(16px, 3vw, 28px);
            opacity: 0.25;
            animation: float-star 6s ease-in-out infinite;
            pointer-events: none;
            z-index: 1;
        }

        @keyframes float-star {

            0%,
            100% {
                transform: translateY(0) rotate(0deg);
            }

            50% {
                transform: translateY(-20px) rotate(15deg);
            }
        }

        /* Score / progress */
        .progress-dots {
            position: absolute;
            top: clamp(12px, 3vw, 24px);
            right: clamp(12px, 3vw, 24px);
            display: flex;
            gap: 8px;
            pointer-events: none;
        }

        .dot {
            width: clamp(14px, 2.5vw, 20px);
            height: clamp(14px, 2.5vw, 20px);
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            border: 2px solid rgba(124, 58, 237, 0.3);
            transition: all 0.4s ease;
        }

        .dot.active {
            background: var(--btn-gradient);
            border-color: transparent;
            box-shadow: 0 0 10px rgba(192, 132, 252, 0.5);
            transform: scale(1.15);
        }

        /* Celebration overlay */
        #celebration {
            position: fixed;
            inset: 0;
            z-index: 100;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: rgba(253, 242, 248, 0.92);
            backdrop-filter: blur(8px);
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.5s ease, visibility 0.5s ease;
        }

        #celebration.show {
            opacity: 1;
            visibility: visible;
        }

        .celebration-text {
            font-size: clamp(2rem, 6vw, 3.5rem);
            font-weight: 800;
            background: var(--btn-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: letter-pop 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
            text-align: center;
            padding: 0 1rem;
        }

        .celebration-emoji {
            font-size: clamp(3rem, 8vw, 5rem);
            margin-bottom: 1rem;
            animation: letter-pop 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) 0.2s both;
        }

        .btn-restart {
            margin-top: 2rem;
            background: var(--btn-gradient);
            box-shadow: var(--glow-pink);
            pointer-events: auto;
            animation: letter-pop 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) 0.4s both;
        }

        /* Sound toggle button */
        .btn-sound {
            position: absolute;
            top: clamp(12px, 3vw, 24px);
            left: clamp(12px, 3vw, 24px);
            width: clamp(42px, 6vw, 56px);
            height: clamp(42px, 6vw, 56px);
            border-radius: 50%;
            border: none;
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(6px);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: clamp(1.2rem, 3vw, 1.6rem);
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
            transition: transform 0.2s ease, background 0.2s ease;
            pointer-events: auto;
            z-index: 20;
            -webkit-tap-highlight-color: transparent;
        }

        .btn-sound:hover {
            transform: scale(1.1);
            background: rgba(255, 255, 255, 0.9);
        }

        .btn-sound:active {
            transform: scale(0.95);
        }

        .btn-sound.muted {
            opacity: 0.5;
        }

        /* Group indicator */
        .group-indicator {
            position: absolute;
            top: clamp(48px, 8vw, 72px);
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            align-items: center;
            gap: 8px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.4s ease;
        }

        .group-indicator.visible {
            opacity: 1;
        }

        .group-label {
            font-size: clamp(0.7rem, 2vw, 0.9rem);
            font-weight: 700;
            color: #a78bfa;
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(4px);
            padding: 4px 14px;
            border-radius: 999px;
            white-space: nowrap;
        }

        /* Overall progress bar */
        .overall-progress {
            position: absolute;
            top: clamp(44px, 7vw, 66px);
            left: 50%;
            transform: translateX(-50%);
            width: min(260px, 60vw);
            height: 6px;
            background: rgba(255, 255, 255, 0.4);
            border-radius: 999px;
            overflow: hidden;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.4s ease;
        }

        .overall-progress.visible {
            opacity: 1;
        }

        .overall-progress-fill {
            height: 100%;
            width: 0%;
            background: var(--btn-gradient);
            border-radius: 999px;
            transition: width 0.5s ease;
        }

        /* Group transition flash */
        .group-flash {
            position: fixed;
            inset: 0;
            z-index: 50;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(253, 242, 248, 0.85);
            backdrop-filter: blur(6px);
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
            pointer-events: none;
        }

        .group-flash.show {
            opacity: 1;
            visibility: visible;
        }

        .group-flash-text {
            font-size: clamp(1.5rem, 5vw, 2.5rem);
            font-weight: 800;
            background: var(--btn-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-align: center;
            animation: letter-pop 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        /* ===== MODE TOGGLE ===== */
        .mode-buttons {
            position: absolute;
            top: clamp(12px, 3vw, 24px);
            left: clamp(62px, 10vw, 90px);
            display: flex;
            gap: 6px;
            pointer-events: auto;
            z-index: 20;
        }

        .btn-mode {
            height: clamp(42px, 6vw, 56px);
            border-radius: 999px;
            border: none;
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(6px);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 0 clamp(12px, 2vw, 18px);
            font-family: var(--font-main);
            font-size: clamp(0.7rem, 2vw, 0.9rem);
            font-weight: 700;
            color: #7c3aed;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
            transition: transform 0.2s ease, background 0.2s ease;
            -webkit-tap-highlight-color: transparent;
        }

        .btn-mode:hover {
            transform: scale(1.06);
            background: rgba(255, 255, 255, 0.9);
        }

        .btn-mode:active {
            transform: scale(0.95);
        }

        .btn-mode .mode-icon {
            font-size: 1.3em;
            line-height: 1;
        }

        /* ===== CHALLENGE MODE ===== */
        #challenge-overlay {
            position: fixed;
            inset: 0;
            z-index: 40;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: rgba(253, 242, 248, 0.94);
            backdrop-filter: blur(10px);
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.4s ease, visibility 0.4s ease;
        }

        #challenge-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .challenge-progress {
            font-size: clamp(0.8rem, 2.5vw, 1rem);
            font-weight: 700;
            color: #a78bfa;
            margin-bottom: 8px;
        }

        .challenge-progress-bar {
            width: min(240px, 55vw);
            height: 6px;
            background: rgba(167, 139, 250, 0.2);
            border-radius: 999px;
            overflow: hidden;
            margin-bottom: clamp(16px, 4vw, 32px);
        }

        .challenge-progress-fill {
            height: 100%;
            width: 0%;
            background: var(--btn-gradient);
            border-radius: 999px;
            transition: width 0.5s ease;
        }

        .challenge-prompt {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: clamp(8px, 2vw, 14px);
            margin-bottom: clamp(10px, 3vw, 20px);
        }

        .challenge-prompt-label {
            font-size: clamp(1rem, 3vw, 1.3rem);
            font-weight: 600;
            color: #6b21a8;
        }

        .challenge-prompt-name {
            font-size: clamp(2.2rem, 7vw, 3.5rem);
            font-weight: 800;
            background: var(--btn-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .challenge-listen-btn {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 8px 20px;
            border: none;
            border-radius: 999px;
            background: linear-gradient(135deg, #34d399, #22d3ee);
            color: #fff;
            font-family: var(--font-main);
            font-size: clamp(0.85rem, 2.5vw, 1rem);
            font-weight: 700;
            cursor: pointer;
            transition: transform 0.2s;
            -webkit-tap-highlight-color: transparent;
        }

        .challenge-listen-btn:active {
            transform: scale(0.93);
        }

        .challenge-feedback {
            min-height: clamp(36px, 6vw, 48px);
            font-size: clamp(1rem, 3vw, 1.4rem);
            font-weight: 800;
            text-align: center;
            margin-bottom: clamp(10px, 3vw, 18px);
            transition: opacity 0.3s ease;
        }

        .challenge-feedback.correct {
            color: #16a34a;
        }

        .challenge-feedback.wrong {
            color: #dc2626;
        }

        .challenge-choices {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: clamp(12px, 3vw, 20px);
            width: min(320px, 75vw);
        }

        .challenge-choice {
            display: flex;
            align-items: center;
            justify-content: center;
            aspect-ratio: 1;
            border: 4px solid rgba(167, 139, 250, 0.3);
            border-radius: clamp(16px, 3vw, 24px);
            background: rgba(255, 255, 255, 0.8);
            font-size: clamp(2.5rem, 8vw, 4rem);
            font-weight: 700;
            cursor: pointer;
            transition: transform 0.15s, border-color 0.2s, background 0.2s;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
        }

        .challenge-choice:active {
            transform: scale(0.92);
        }

        .challenge-choice.correct-flash {
            border-color: #16a34a;
            background: rgba(134, 239, 172, 0.4);
            animation: letter-pop 0.4s ease;
        }

        .challenge-choice.wrong-flash {
            border-color: #dc2626;
            background: rgba(252, 165, 165, 0.3);
            animation: shake 0.4s ease;
        }

        @keyframes shake {

            0%,
            100% {
                transform: translateX(0);
            }

            20% {
                transform: translateX(-8px);
            }

            40% {
                transform: translateX(8px);
            }

            60% {
                transform: translateX(-6px);
            }

            80% {
                transform: translateX(4px);
            }
        }

        /* ===== DRAW MODE ===== */
        #draw-overlay {
            position: fixed;
            inset: 0;
            z-index: 40;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: rgba(253, 242, 248, 0.94);
            backdrop-filter: blur(10px);
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.4s ease, visibility 0.4s ease;
        }

        #draw-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .draw-prompt {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: clamp(4px, 1.5vw, 10px);
            margin-bottom: clamp(8px, 2vw, 16px);
        }

        .draw-prompt-label {
            font-size: clamp(1rem, 3vw, 1.3rem);
            font-weight: 600;
            color: #6b21a8;
        }

        .draw-prompt-name {
            font-size: clamp(1.6rem, 5vw, 2.5rem);
            font-weight: 800;
            background: var(--btn-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .draw-canvas-container {
            position: relative;
            width: min(300px, 75vw);
            height: min(300px, 75vw);
            border-radius: clamp(16px, 3vw, 24px);
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(124, 58, 237, 0.12);
            border: 4px solid rgba(167, 139, 250, 0.3);
            background: #fff;
        }

        .draw-canvas-container canvas {
            display: block;
            width: 100%;
            height: 100%;
            cursor: crosshair;
            touch-action: none;
        }

        .draw-reference {
            position: absolute;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: min(200px, 50vw);
            color: rgba(167, 139, 250, 0.12);
            pointer-events: none;
            font-family: 'Arial', 'Noto Sans Arabic', sans-serif;
            line-height: 1;
        }

        .draw-toolbar {
            display: flex;
            gap: clamp(10px, 2vw, 16px);
            margin-top: clamp(8px, 2vw, 14px);
        }

        .draw-toolbar .btn {
            padding: clamp(10px, 2vw, 14px) clamp(20px, 4vw, 32px);
            font-size: clamp(0.85rem, 2.5vw, 1.1rem);
        }

        .btn-clear {
            background: linear-gradient(135deg, #f97316, #ef4444);
            box-shadow: 0 0 15px rgba(249, 115, 22, 0.3);
        }

        .btn-check {
            background: var(--btn-gradient);
            box-shadow: var(--glow-pink);
        }

        /* ===== SORT MODE ===== */
        #sort-overlay {
            position: fixed;
            inset: 0;
            z-index: 40;
            display: flex;
            flex-direction: column;
            align-items: center;
            background: linear-gradient(180deg, #87CEEB 0%, #b6e3f4 40%, #d4f0c0 60%, #a8d98a 100%);
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.4s ease, visibility 0.4s ease;
            overflow: hidden;
        }

        #sort-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .sort-header {
            width: 100%;
            text-align: center;
            padding: clamp(8px, 2vw, 14px) 0 0;
            z-index: 10;
        }

        /* Sort Legend Button */
        .btn-legend {
            position: absolute;
            top: clamp(12px, 3vw, 24px);
            right: clamp(12px, 3vw, 24px);
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.9);
            border: 2px solid #8B6914;
            border-radius: 999px;
            color: #d97706;
            font-weight: 800;
            font-size: clamp(0.8rem, 2vw, 1rem);
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 20;
            pointer-events: auto;
            transition: transform 0.2s, background 0.2s;
        }

        .btn-legend:hover {
            transform: scale(1.05);
            background: #fff;
        }

        .btn-legend:active {
            transform: scale(0.95);
        }

        /* Sort Targets (5 Trees) */
        .sort-targets {
            display: flex;
            justify-content: center;
            align-items: flex-end;
            gap: clamp(8px, 2vw, 16px);
            padding: clamp(10px, 2vw, 20px) clamp(10px, 2vw, 20px) 0;
            z-index: 2;
            width: 100%;
            height: 45vh;
            /* Upper half for the trees */
        }

        .sort-target-tree {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-end;
            width: clamp(75px, 19vw, 160px);
            height: calc(100% - 35px);
            /* Leave space for sign at bottom */
            margin-bottom: 35px;
            background-image: var(--tree-bg, url('apple-tree.png'));
            background-repeat: no-repeat;
            background-position: center bottom;
            background-size: contain;
            position: relative;
            transition: transform 0.2s ease, filter 0.2s ease;
        }

        .sort-target-tree.highlight {
            transform: scale(1.05);
            filter: drop-shadow(0 0 12px rgba(52, 211, 153, 0.8));
        }

        /* The sign hanging on the tree */
        .sort-tree-sign {
            position: absolute;
            bottom: -30px;
            /* Positioned below the tree roots */
            background: rgba(255, 255, 255, 0.9);
            border: 2px solid #8B6914;
            border-radius: 8px;
            padding: 2px 6px;
            text-align: center;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
            pointer-events: none;
            width: 100%;
            box-sizing: border-box;
        }

        .sort-tree-label {
            font-size: clamp(0.55rem, 1.5vw, 0.8rem);
            font-weight: 800;
            color: #8B6914;
        }

        .sort-tree-count {
            font-size: clamp(0.6rem, 1.6vw, 0.9rem);
            font-weight: 800;
            color: #d97706;
        }

        .sort-ground {
            position: relative;
            flex: 1;
            width: 100%;
            z-index: 3;
            /* Grass area already provided by overlay background, just need relative container */
        }

        .sort-tree-canopy {
            position: absolute;
            bottom: 35px;
            /* Offset by the margin-bottom of the tree container */
            left: 0;
            width: 100%;
            aspect-ratio: 1 / 1;
            pointer-events: none;
            z-index: 2;
        }

        .sort-shadow-apple {
            width: clamp(28px, 6vw, 44px);
            height: clamp(28px, 6vw, 44px);
            background: rgba(0, 0, 0, 0.4);
            border: 2px dashed rgba(255, 255, 255, 0.5);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: clamp(0.7rem, 2.2vw, 1.2rem);
            font-weight: 700;
            color: rgba(255, 255, 255, 0.8);
            position: absolute;
            transform: translate(-50%, -50%);
        }

        .sort-apple {
            width: clamp(28px, 6vw, 44px);
            height: clamp(28px, 6vw, 44px);
            background: radial-gradient(circle at 35% 35%, #ff6b6b, #e53e3e, #c53030);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: clamp(0.7rem, 2.2vw, 1.2rem);
            font-weight: 700;
            color: #fff;
            cursor: grab;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2), inset 0 -3px 6px rgba(0, 0, 0, 0.15);
            transition: transform 0.15s ease, box-shadow 0.15s ease;
            user-select: none;
            -webkit-user-select: none;
            touch-action: none;
            z-index: 5;
            position: absolute;
        }

        .sort-apple::before {
            content: 'üåø';
            position: absolute;
            top: -8px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.6em;
        }

        .sort-apple:active {
            cursor: grabbing;
            transform: scale(1.15);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        .sort-apple.dragging {
            opacity: 0.85;
            transform: scale(1.2);
            z-index: 100;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.35);
            pointer-events: none;
        }

        .sort-apple.sorted {
            opacity: 0;
            transform: scale(0);
            pointer-events: none;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        /* Legend Modal */
        .legend-modal {
            position: fixed;
            inset: 0;
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
            pointer-events: none;
        }

        .legend-modal.show {
            opacity: 1;
            visibility: visible;
            pointer-events: auto;
        }

        .legend-modal-content {
            position: relative;
            background: #fff;
            width: min(90vw, 500px);
            max-height: 80vh;
            border-radius: 20px;
            padding: clamp(16px, 4vw, 24px);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            border: 4px solid #f472b6;
            display: flex;
            flex-direction: column;
            animation: letter-pop 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .legend-close-btn {
            position: absolute;
            top: 12px;
            right: 12px;
            background: #f1f5f9;
            border: none;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s, transform 0.2s;
        }

        .legend-close-btn:hover {
            background: #e2e8f0;
            transform: scale(1.1);
        }

        .legend-modal-title {
            font-size: clamp(1.4rem, 4vw, 1.8rem);
            font-weight: 800;
            color: #d97706;
            text-align: center;
            margin-bottom: 16px;
            border-bottom: 2px dashed #fcd34d;
            padding-bottom: 8px;
        }

        .legend-modal-body {
            overflow-y: auto;
            flex: 1;
            padding-right: 8px;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .legend-group {
            background: #fdf2f8;
            border-radius: 12px;
            padding: 12px;
            border: 1px solid #fbcfe8;
        }

        .legend-group h3 {
            font-size: 1rem;
            color: #db2777;
            margin-bottom: 8px;
        }

        .legend-items {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .legend-item {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: #fff;
            padding: 4px 10px;
            border-radius: 999px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            font-size: 0.9rem;
            font-weight: 700;
        }

        .legend-item .ar {
            font-size: 1.3rem;
            color: #7c3aed;
        }

        .legend-item .la {
            color: #475569;
        }

        .sort-feedback {
            min-height: clamp(28px, 5vw, 38px);
            font-size: clamp(0.8rem, 2.5vw, 1.1rem);
            font-weight: 700;
            text-align: center;
            padding: 4px 12px;
            z-index: 2;
            transition: opacity 0.3s ease;
        }

        .sort-feedback.correct {
            color: #065f46;
        }

        .sort-feedback.wrong {
            color: #991b1b;
        }

        .sort-bottom-bar {
            display: flex;
            align-items: center;
            gap: clamp(8px, 2vw, 14px);
            padding-bottom: clamp(8px, 2vw, 14px);
            z-index: 2;
            flex-shrink: 0;
        }

        @keyframes apple-bounce {
            0% {
                transform: scale(1);
            }

            30% {
                transform: scale(0.85);
            }

            60% {
                transform: scale(1.1);
            }

            100% {
                transform: scale(1);
            }
        }
    </style>
</head>

<body>

    <!-- Loading Screen -->
    <div id="loading-screen">
        <div class="loading-cube"></div>
        <div class="loading-title">Magical Hijaiyah Cube ‚ú®</div>
        <div class="loading-bar-container">
            <div class="loading-bar-fill" id="loading-bar"></div>
        </div>
    </div>

    <!-- Game Canvas -->
    <canvas id="game-canvas"></canvas>

    <!-- UI Overlay -->
    <div id="ui-overlay">
        <div class="header">
            <h1>‚ú® Magical Hijaiyah Cube ‚ú®</h1>
        </div>

        <button class="btn-sound" id="btn-sound" title="Toggle Sound">üîä</button>
        <div class="mode-buttons">
            <button class="btn-mode" id="btn-mode" title="Challenge Mode">
                <span class="mode-icon">‚úèÔ∏è</span> Challenge
            </button>
            <button class="btn-mode" id="btn-draw-mode" title="Draw Mode">
                <span class="mode-icon">üñåÔ∏è</span> Draw
            </button>
            <button class="btn-mode" id="btn-sort-mode" title="Sort Mode">
                <span class="mode-icon">üß∫</span> Sort
            </button>
        </div>

        <div class="overall-progress" id="overall-progress">
            <div class="overall-progress-fill" id="overall-progress-fill"></div>
        </div>

        <div class="group-indicator" id="group-indicator">
            <span class="group-label" id="group-label">Group 1/5</span>
        </div>

        <div class="progress-dots" id="progress-dots"></div>

        <div id="letter-display">
            <div class="letter-arabic" id="letter-arabic"></div>
            <div class="letter-name" id="letter-name"></div>
        </div>

        <div class="btn-container">
            <button class="btn btn-tap" id="btn-tap">
                <span class="btn-emoji">üëÜ</span> Tap Cube!
            </button>
            <button class="btn btn-next" id="btn-next">
                Next Letter <span class="btn-emoji">‚û°Ô∏è</span>
            </button>
        </div>
    </div>

    <!-- Celebration -->
    <div id="celebration">
        <div class="celebration-emoji">üéâ</div>
        <div class="celebration-text" id="celebration-text">Amazing Job! üåü<br>You learned all the letters!</div>
        <button class="btn btn-restart" id="btn-restart">
            <span class="btn-emoji">üîÑ</span> Play Again!
        </button>
    </div>

    <!-- Group transition flash -->
    <div class="group-flash" id="group-flash">
        <div class="group-flash-text" id="group-flash-text">‚≠ê Great! Next group!</div>
    </div>

    <!-- Challenge Mode Overlay -->
    <div id="challenge-overlay">
        <div class="challenge-progress" id="challenge-progress">1 / 28</div>
        <div class="challenge-progress-bar">
            <div class="challenge-progress-fill" id="challenge-progress-fill"></div>
        </div>
        <div class="challenge-prompt">
            <div class="challenge-prompt-label">Which letter is this? ü§î</div>
            <button class="challenge-listen-btn" id="challenge-listen-btn">üîä Listen</button>
        </div>
        <div class="challenge-feedback" id="challenge-feedback"></div>
        <div class="challenge-choices" id="challenge-choices"></div>
        <button class="btn btn-tap" id="btn-exit-challenge"
            style="margin-top: clamp(16px,4vw,28px); pointer-events:auto;">
            <span class="btn-emoji">üé≤</span> Back to Explore
        </button>
    </div>

    <!-- Draw Mode Overlay -->
    <div id="draw-overlay">
        <div class="challenge-progress" id="draw-progress">1 / 28</div>
        <div class="challenge-progress-bar">
            <div class="challenge-progress-fill" id="draw-progress-fill"></div>
        </div>
        <div class="draw-prompt">
            <div class="draw-prompt-label">Draw this letter ‚úçÔ∏è</div>
            <div class="draw-prompt-name" id="draw-prompt-name">Alif</div>
        </div>
        <div class="draw-canvas-container">
            <div class="draw-reference" id="draw-reference">ÿß</div>
            <canvas id="draw-canvas" width="300" height="300"></canvas>
        </div>
        <div class="challenge-feedback" id="draw-feedback"></div>
        <div class="draw-toolbar">
            <button class="btn btn-clear" id="btn-draw-clear">
                <span class="btn-emoji">üóëÔ∏è</span> Clear
            </button>
            <button class="btn btn-check" id="btn-draw-check">
                <span class="btn-emoji">‚úÖ</span> Check
            </button>
        </div>
        <button class="btn btn-tap" id="btn-exit-draw" style="margin-top: clamp(12px,3vw,20px); pointer-events:auto;">
            <span class="btn-emoji">üé≤</span> Back to Explore
        </button>
    </div>

    <!-- Sort Mode Overlay -->
    <div id="sort-overlay">
        <div class="sort-header">
            <div class="challenge-progress" id="sort-progress">0 / 28</div>
            <div class="challenge-progress-bar" style="margin: 4px auto; width: min(240px, 55vw);">
                <div class="challenge-progress-fill" id="sort-progress-fill"></div>
            </div>
        </div>

        <!-- Legend Button -->
        <button class="btn btn-legend" id="btn-sort-legend" title="Show Legend">
            <span class="btn-emoji">üìñ</span> Legend
        </button>

        <!-- 5 Target Trees Container -->
        <div class="sort-targets" id="sort-targets"></div>

        <!-- Ground for scattered apples -->
        <div class="sort-ground" id="sort-ground"></div>

        <div class="sort-feedback" id="sort-feedback"></div>
        <div class="sort-bottom-bar">
            <button class="btn btn-tap" id="btn-exit-sort" style="pointer-events:auto;">
                <span class="btn-emoji">üé≤</span> Back to Explore
            </button>
        </div>
    </div>

    <!-- Sort Legend Modal -->
    <div class="legend-modal" id="legend-modal">
        <div class="legend-modal-content">
            <button class="legend-close-btn" id="btn-legend-close">‚ùå</button>
            <div class="legend-modal-title">Kamus Hijaiyah</div>
            <div class="legend-modal-body" id="legend-modal-body"></div>
        </div>
    </div>

    <!-- Floating Stars -->
    <div class="floating-star" style="top:10%;left:5%;animation-delay:0s">‚≠ê</div>
    <div class="floating-star" style="top:20%;right:8%;animation-delay:1.5s">üåü</div>
    <div class="floating-star" style="bottom:15%;left:10%;animation-delay:3s">‚ú®</div>
    <div class="floating-star" style="bottom:25%;right:5%;animation-delay:4.5s">üí´</div>

    <!-- GSAP (non-module, loads globally) -->
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>

    <!-- Three.js via import map + ES modules -->
    <script type="importmap">
  {
    "imports": {
      "three": "https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js",
      "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/"
    }
  }
  </script>

    <script type="module">
        import * as THREE from 'three';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
        import { RoundedBoxGeometry } from 'three/addons/geometries/RoundedBoxGeometry.js';

        // Make available globally for classes
        window.THREE = THREE;
        window.RoundedBoxGeometry = RoundedBoxGeometry;

        // ==========================================
        // DATA: All 28 Hijaiyah Letters
        // ==========================================
        const COLOR_PALETTE = [
            { color: '#fca5a5', bg: '#fef2f2', accent: '#ef4444' }, // Rose
            { color: '#93c5fd', bg: '#eff6ff', accent: '#3b82f6' }, // Blue
            { color: '#86efac', bg: '#f0fdf4', accent: '#22c55e' }, // Green
            { color: '#fde68a', bg: '#fefce8', accent: '#eab308' }, // Amber
            { color: '#c4b5fd', bg: '#f5f3ff', accent: '#8b5cf6' }, // Violet
            { color: '#fdba74', bg: '#fff7ed', accent: '#f97316' }, // Orange
        ];

        const ALL_HIJAIYAH = [
            // Group 1: ÿ£ - ÿ≠
            { arabic: '\u0627', name: 'Alif', voice: '\u0623\u064e\u0644\u0650\u0641\u0652' },
            { arabic: '\u0628', name: 'Ba', voice: '\u0628\u064e\u0627\u0621\u0652' },
            { arabic: '\u062a', name: 'Ta', voice: '\u062a\u064e\u0627\u0621\u0652' },
            { arabic: '\u062b', name: 'Tsa', voice: '\u062b\u064e\u0627\u0621\u0652' },
            { arabic: '\u062c', name: 'Jim', voice: '\u062c\u0650\u064a\u0645\u0652' },
            { arabic: '\u062d', name: 'Ha', voice: '\u062d\u064e\u0627\u0621\u0652' },
            // Group 2: ÿÆ - ÿ≥
            { arabic: '\u062e', name: 'Kha', voice: '\u062e\u064e\u0627\u0621\u0652' },
            { arabic: '\u062f', name: 'Dal', voice: '\u062f\u064e\u0627\u0644\u0652' },
            { arabic: '\u0630', name: 'Dzal', voice: '\u0630\u064e\u0627\u0644\u0652' },
            { arabic: '\u0631', name: 'Ra', voice: '\u0631\u064e\u0627\u0621\u0652' },
            { arabic: '\u0632', name: 'Zai', voice: '\u0632\u064e\u0627\u064a\u0652' },
            { arabic: '\u0633', name: 'Sin', voice: '\u0633\u0650\u064a\u0646\u0652' },
            // Group 3: ÿ¥ - ÿπ
            { arabic: '\u0634', name: 'Syin', voice: '\u0634\u0650\u064a\u0646\u0652' },
            { arabic: '\u0635', name: 'Shad', voice: '\u0635\u064e\u0627\u062f\u0652' },
            { arabic: '\u0636', name: 'Dhad', voice: '\u0636\u064e\u0627\u062f\u0652' },
            { arabic: '\u0637', name: 'Tha', voice: '\u0637\u064e\u0627\u0621\u0652' },
            { arabic: '\u0638', name: 'Zha', voice: '\u0638\u064e\u0627\u0621\u0652' },
            { arabic: '\u0639', name: "'Ain", voice: '\u0639\u064e\u064a\u0652\u0646\u0652' },
            // Group 4: ÿ∫ - ŸÖ
            { arabic: '\u063a', name: 'Ghain', voice: '\u063a\u064e\u064a\u0652\u0646\u0652' },
            { arabic: '\u0641', name: 'Fa', voice: '\u0641\u064e\u0627\u0621\u0652' },
            { arabic: '\u0642', name: 'Qaf', voice: '\u0642\u064e\u0627\u0641\u0652' },
            { arabic: '\u0643', name: 'Kaf', voice: '\u0643\u064e\u0627\u0641\u0652' },
            { arabic: '\u0644', name: 'Lam', voice: '\u0644\u0627\u064e\u0645\u0652' },
            { arabic: '\u0645', name: 'Mim', voice: '\u0645\u0650\u064a\u0645\u0652' },
            // Group 5: ŸÜ - Ÿä
            { arabic: '\u0646', name: 'Nun', voice: '\u0646\u064f\u0648\u0646\u0652' },
            { arabic: '\u0648', name: 'Wau', voice: '\u0648\u064e\u0627\u0648\u0652' },
            { arabic: '\u0647', name: "Ha'", voice: '\u0647\u064e\u0627\u0621\u0652' },
            { arabic: '\u064a', name: 'Ya', voice: '\u064a\u064e\u0627\u0621\u0652' },
        ];

        // Assign cycling colors from palette
        ALL_HIJAIYAH.forEach((letter, i) => {
            const pal = COLOR_PALETTE[i % COLOR_PALETTE.length];
            letter.color = pal.color;
            letter.bg = pal.bg;
            letter.accent = pal.accent;
        });

        const LETTERS_PER_GROUP = 6;
        const TOTAL_GROUPS = Math.ceil(ALL_HIJAIYAH.length / LETTERS_PER_GROUP);

        function getGroupLetters(groupIndex) {
            const start = groupIndex * LETTERS_PER_GROUP;
            return ALL_HIJAIYAH.slice(start, start + LETTERS_PER_GROUP);
        }

        // ==========================================
        // CLASS: SoundManager (Web Audio API Synthesis)
        // ==========================================
        class SoundManager {
            constructor() {
                this.ctx = null;
                this.muted = false;
                this.bgMusicGain = null;
                this.bgMusicStarted = false;
                this._pendingResume = false;
            }

            // Must be called from a user gesture (click/touch)
            init() {
                if (this.ctx) return;
                this.ctx = new (window.AudioContext || window.webkitAudioContext)();
                this.masterGain = this.ctx.createGain();
                this.masterGain.gain.value = 0.5;
                this.masterGain.connect(this.ctx.destination);
            }

            // Ensure AudioContext is resumed (browsers require user gesture)
            async _ensureResumed() {
                if (this.ctx && this.ctx.state === 'suspended') {
                    await this.ctx.resume();
                }
            }

            toggleMute() {
                this.muted = !this.muted;
                if (this.masterGain) {
                    this.masterGain.gain.setTargetAtTime(
                        this.muted ? 0 : 0.5, this.ctx.currentTime, 0.05
                    );
                }
                return this.muted;
            }

            // --- Pop / Boing (cube tap) ---
            playPop() {
                if (!this.ctx || this.muted) return;
                this._ensureResumed();
                const t = this.ctx.currentTime;

                // Main pop tone
                const osc = this.ctx.createOscillator();
                const gain = this.ctx.createGain();
                osc.type = 'sine';
                osc.frequency.setValueAtTime(600, t);
                osc.frequency.exponentialRampToValueAtTime(200, t + 0.15);
                gain.gain.setValueAtTime(0.4, t);
                gain.gain.exponentialRampToValueAtTime(0.001, t + 0.25);
                osc.connect(gain);
                gain.connect(this.masterGain);
                osc.start(t);
                osc.stop(t + 0.25);

                // Boing overtone
                const osc2 = this.ctx.createOscillator();
                const gain2 = this.ctx.createGain();
                osc2.type = 'triangle';
                osc2.frequency.setValueAtTime(900, t);
                osc2.frequency.exponentialRampToValueAtTime(300, t + 0.2);
                gain2.gain.setValueAtTime(0.2, t);
                gain2.gain.exponentialRampToValueAtTime(0.001, t + 0.2);
                osc2.connect(gain2);
                gain2.connect(this.masterGain);
                osc2.start(t);
                osc2.stop(t + 0.2);
            }

            // --- Whoosh (cube rotation) ---
            playWhoosh() {
                if (!this.ctx || this.muted) return;
                this._ensureResumed();
                const t = this.ctx.currentTime;

                // Filtered noise sweep
                const bufferSize = this.ctx.sampleRate * 0.3;
                const buffer = this.ctx.createBuffer(1, bufferSize, this.ctx.sampleRate);
                const data = buffer.getChannelData(0);
                for (let i = 0; i < bufferSize; i++) {
                    data[i] = (Math.random() * 2 - 1) * 0.3;
                }
                const noise = this.ctx.createBufferSource();
                noise.buffer = buffer;

                const filter = this.ctx.createBiquadFilter();
                filter.type = 'bandpass';
                filter.frequency.setValueAtTime(400, t);
                filter.frequency.exponentialRampToValueAtTime(2000, t + 0.15);
                filter.frequency.exponentialRampToValueAtTime(300, t + 0.3);
                filter.Q.value = 2;

                const gain = this.ctx.createGain();
                gain.gain.setValueAtTime(0.001, t);
                gain.gain.linearRampToValueAtTime(0.25, t + 0.08);
                gain.gain.exponentialRampToValueAtTime(0.001, t + 0.3);

                noise.connect(filter);
                filter.connect(gain);
                gain.connect(this.masterGain);
                noise.start(t);
                noise.stop(t + 0.3);
            }

            // --- Sparkle chime (letter display) ---
            playSparkle() {
                if (!this.ctx || this.muted) return;
                this._ensureResumed();
                const t = this.ctx.currentTime;

                // Ascending chime notes (pentatonic)
                const notes = [523, 659, 784, 1047]; // C5, E5, G5, C6
                notes.forEach((freq, i) => {
                    const osc = this.ctx.createOscillator();
                    const gain = this.ctx.createGain();
                    osc.type = 'sine';
                    osc.frequency.value = freq;
                    const start = t + i * 0.07;
                    gain.gain.setValueAtTime(0, start);
                    gain.gain.linearRampToValueAtTime(0.2, start + 0.02);
                    gain.gain.exponentialRampToValueAtTime(0.001, start + 0.35);
                    osc.connect(gain);
                    gain.connect(this.masterGain);
                    osc.start(start);
                    osc.stop(start + 0.35);
                });
            }

            // --- Celebration fanfare ---
            playCelebration() {
                if (!this.ctx || this.muted) return;
                this._ensureResumed();
                const t = this.ctx.currentTime;

                // Ascending arpeggio fanfare
                const fanfare = [262, 330, 392, 523, 659, 784, 1047];
                fanfare.forEach((freq, i) => {
                    const osc = this.ctx.createOscillator();
                    const gain = this.ctx.createGain();
                    osc.type = i < 4 ? 'triangle' : 'sine';
                    osc.frequency.value = freq;
                    const start = t + i * 0.12;
                    gain.gain.setValueAtTime(0, start);
                    gain.gain.linearRampToValueAtTime(0.3, start + 0.03);
                    gain.gain.setValueAtTime(0.3, start + 0.15);
                    gain.gain.exponentialRampToValueAtTime(0.001, start + 0.5);
                    osc.connect(gain);
                    gain.connect(this.masterGain);
                    osc.start(start);
                    osc.stop(start + 0.5);
                });

                // Final sustained chord
                const chordStart = t + fanfare.length * 0.12;
                [523, 659, 784].forEach((freq) => {
                    const osc = this.ctx.createOscillator();
                    const gain = this.ctx.createGain();
                    osc.type = 'sine';
                    osc.frequency.value = freq;
                    gain.gain.setValueAtTime(0, chordStart);
                    gain.gain.linearRampToValueAtTime(0.2, chordStart + 0.05);
                    gain.gain.exponentialRampToValueAtTime(0.001, chordStart + 1.5);
                    osc.connect(gain);
                    gain.connect(this.masterGain);
                    osc.start(chordStart);
                    osc.stop(chordStart + 1.5);
                });
            }

            // --- Button click feedback ---
            playClick() {
                if (!this.ctx || this.muted) return;
                this._ensureResumed();
                const t = this.ctx.currentTime;

                const osc = this.ctx.createOscillator();
                const gain = this.ctx.createGain();
                osc.type = 'sine';
                osc.frequency.setValueAtTime(800, t);
                osc.frequency.exponentialRampToValueAtTime(500, t + 0.06);
                gain.gain.setValueAtTime(0.15, t);
                gain.gain.exponentialRampToValueAtTime(0.001, t + 0.08);
                osc.connect(gain);
                gain.connect(this.masterGain);
                osc.start(t);
                osc.stop(t + 0.08);
            }

            // --- Error buzz (wrong answer) ---
            playBuzz() {
                if (!this.ctx || this.muted) return;
                this._ensureResumed();
                const t = this.ctx.currentTime;

                const osc = this.ctx.createOscillator();
                const gain = this.ctx.createGain();
                osc.type = 'sawtooth';
                osc.frequency.setValueAtTime(150, t);
                osc.frequency.linearRampToValueAtTime(100, t + 0.25);
                gain.gain.setValueAtTime(0.2, t);
                gain.gain.exponentialRampToValueAtTime(0.001, t + 0.3);
                osc.connect(gain);
                gain.connect(this.masterGain);
                osc.start(t);
                osc.stop(t + 0.3);
            }

            // --- Background music (gentle looping melody) ---
            startBgMusic() {
                if (!this.ctx || this.bgMusicStarted || this.muted) return;
                this._ensureResumed();
                this.bgMusicStarted = true;
                this._playMelodyLoop();
            }

            _playMelodyLoop() {
                if (!this.ctx || !this.bgMusicStarted) return;

                const t = this.ctx.currentTime;
                this.bgMusicGain = this.ctx.createGain();
                this.bgMusicGain.gain.value = this.muted ? 0 : 0.08;
                this.bgMusicGain.connect(this.masterGain);

                // Pentatonic lullaby melody (C D E G A)
                const melody = [
                    { note: 523, dur: 0.4 },  // C5
                    { note: 587, dur: 0.4 },  // D5
                    { note: 659, dur: 0.6 },  // E5
                    { note: 523, dur: 0.3 },  // C5
                    { note: 0, dur: 0.3 },     // rest
                    { note: 784, dur: 0.4 },  // G5
                    { note: 659, dur: 0.4 },  // E5
                    { note: 587, dur: 0.6 },  // D5
                    { note: 0, dur: 0.4 },     // rest
                    { note: 659, dur: 0.3 },  // E5
                    { note: 784, dur: 0.3 },  // G5
                    { note: 880, dur: 0.5 },  // A5
                    { note: 784, dur: 0.4 },  // G5
                    { note: 0, dur: 0.3 },     // rest
                    { note: 659, dur: 0.4 },  // E5
                    { note: 523, dur: 0.8 },  // C5
                    { note: 0, dur: 0.6 },     // rest
                ];

                let offset = 0;
                melody.forEach(({ note, dur }) => {
                    if (note > 0) {
                        const osc = this.ctx.createOscillator();
                        const noteGain = this.ctx.createGain();
                        osc.type = 'sine';
                        osc.frequency.value = note;
                        const start = t + offset;
                        noteGain.gain.setValueAtTime(0, start);
                        noteGain.gain.linearRampToValueAtTime(1, start + 0.03);
                        noteGain.gain.setValueAtTime(1, start + dur * 0.6);
                        noteGain.gain.exponentialRampToValueAtTime(0.001, start + dur);
                        osc.connect(noteGain);
                        noteGain.connect(this.bgMusicGain);
                        osc.start(start);
                        osc.stop(start + dur + 0.01);
                    }
                    offset += dur;
                });

                // Schedule next loop
                const totalDuration = offset;
                this._bgMusicTimer = setTimeout(() => {
                    this._playMelodyLoop();
                }, totalDuration * 1000);
            }

            stopBgMusic() {
                this.bgMusicStarted = false;
                if (this._bgMusicTimer) {
                    clearTimeout(this._bgMusicTimer);
                    this._bgMusicTimer = null;
                }
            }

            // --- Hijaiyah letter voice pronunciation ---
            // Detect iOS for special handling
            get _isIOS() {
                return /iPad|iPhone|iPod/.test(navigator.userAgent) ||
                    (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1);
            }

            // Pre-load speech synthesis voices
            _preloadVoices() {
                if (!window.speechSynthesis) return;
                this._voices = speechSynthesis.getVoices();
                if (this._voices.length === 0) {
                    speechSynthesis.addEventListener('voiceschanged', () => {
                        this._voices = speechSynthesis.getVoices();
                    }, { once: true });
                }
            }

            playLetterVoice(letter) {
                if (this.muted) return;

                // Cancel any ongoing speech
                if (window.speechSynthesis) {
                    window.speechSynthesis.cancel();
                }
                // Stop any previous audio
                if (this._voiceAudio) {
                    this._voiceAudio.pause();
                    this._voiceAudio = null;
                }

                const voiceText = letter.voice || letter.arabic;

                // iOS Safari: Google TTS is blocked by CORS/autoplay.
                // Use Web Speech API directly (must be called synchronously
                // from user gesture ‚Äî no setTimeout!).
                if (this._isIOS) {
                    this._speakWithSpeechAPI(voiceText);
                    return;
                }

                // Desktop/Android: try Google TTS first, fallback to Speech API
                this._tryGoogleTTS(voiceText)
                    .catch(() => {
                        this._speakWithSpeechAPI(voiceText);
                    });
            }

            _tryGoogleTTS(text) {
                return new Promise((resolve, reject) => {
                    try {
                        const url = `https://translate.google.com/translate_tts?ie=UTF-8&q=${encodeURIComponent(text)}&tl=ar&client=tw-ob`;
                        const audio = new Audio(url);
                        audio.volume = this.muted ? 0 : 0.8;
                        this._voiceAudio = audio;

                        audio.onended = () => {
                            this._voiceAudio = null;
                            resolve();
                        };
                        audio.onerror = () => {
                            this._voiceAudio = null;
                            reject(new Error('Google TTS failed'));
                        };

                        // Timeout fallback if audio doesn't play within 3s
                        const timeout = setTimeout(() => {
                            if (audio.paused) {
                                this._voiceAudio = null;
                                reject(new Error('Google TTS timeout'));
                            }
                        }, 3000);

                        audio.play()
                            .then(() => clearTimeout(timeout))
                            .catch(() => {
                                clearTimeout(timeout);
                                this._voiceAudio = null;
                                reject(new Error('Google TTS play failed'));
                            });
                    } catch (e) {
                        reject(e);
                    }
                });
            }

            _speakWithSpeechAPI(text) {
                if (!window.speechSynthesis) return;

                const utter = new SpeechSynthesisUtterance(text);
                utter.lang = 'ar-SA';
                utter.rate = 0.8;   // Slower for children
                utter.pitch = 1.1;  // Slightly higher pitch
                utter.volume = this.muted ? 0 : 0.9;

                // Try to find Arabic voice
                const voices = this._voices || speechSynthesis.getVoices();
                const arVoice = voices.find(v => v.lang.startsWith('ar'));
                if (arVoice) utter.voice = arVoice;

                speechSynthesis.speak(utter);
            }

            dispose() {
                this.stopBgMusic();
                if (this.ctx) {
                    this.ctx.close();
                    this.ctx = null;
                }
            }
        }

        // ==========================================
        // CLASS: TextureGenerator
        // ==========================================
        class TextureGenerator {
            constructor() {
                this.size = 512;
            }

            createLetterTexture(letter) {
                const canvas = document.createElement('canvas');
                canvas.width = this.size;
                canvas.height = this.size;
                const ctx = canvas.getContext('2d');

                // Background with soft gradient
                const grad = ctx.createRadialGradient(
                    this.size / 2, this.size / 2, 0,
                    this.size / 2, this.size / 2, this.size * 0.7
                );
                grad.addColorStop(0, '#ffffff');
                grad.addColorStop(1, letter.bg);
                ctx.fillStyle = grad;
                this._roundRect(ctx, 0, 0, this.size, this.size, 40);
                ctx.fill();

                // Decorative border
                ctx.strokeStyle = letter.color;
                ctx.lineWidth = 12;
                this._roundRect(ctx, 16, 16, this.size - 32, this.size - 32, 30);
                ctx.stroke();

                // Inner glow circle
                ctx.beginPath();
                ctx.arc(this.size / 2, this.size / 2 - 10, this.size * 0.28, 0, Math.PI * 2);
                ctx.fillStyle = letter.color + '33';
                ctx.fill();

                // Arabic letter
                ctx.fillStyle = letter.accent;
                ctx.font = `bold ${this.size * 0.45}px "Arial", "Noto Sans Arabic", sans-serif`;
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.shadowColor = letter.accent + '44';
                ctx.shadowBlur = 15;
                ctx.fillText(letter.arabic, this.size / 2, this.size / 2 - 10);

                // Reset shadow
                ctx.shadowColor = 'transparent';
                ctx.shadowBlur = 0;

                // Letter name at bottom
                ctx.fillStyle = letter.accent;
                ctx.font = `700 ${this.size * 0.1}px "Outfit", sans-serif`;
                ctx.fillText(letter.name, this.size / 2, this.size * 0.85);

                // Small decorative dots
                const dotPositions = [
                    [this.size * 0.15, this.size * 0.15],
                    [this.size * 0.85, this.size * 0.15],
                    [this.size * 0.15, this.size * 0.85],
                    [this.size * 0.85, this.size * 0.85],
                ];
                dotPositions.forEach(([x, y]) => {
                    ctx.beginPath();
                    ctx.arc(x, y, 8, 0, Math.PI * 2);
                    ctx.fillStyle = letter.color;
                    ctx.fill();
                });

                const texture = new THREE.CanvasTexture(canvas);
                texture.colorSpace = THREE.SRGBColorSpace;
                return texture;
            }

            createGrassTexture() {
                const canvas = document.createElement('canvas');
                canvas.width = 512;
                canvas.height = 512;
                const ctx = canvas.getContext('2d');

                // Base green
                const grad = ctx.createLinearGradient(0, 0, 512, 512);
                grad.addColorStop(0, '#bbf7d0');
                grad.addColorStop(0.5, '#a7f3d0');
                grad.addColorStop(1, '#86efac');
                ctx.fillStyle = grad;
                ctx.fillRect(0, 0, 512, 512);

                // Soft texture dots
                for (let i = 0; i < 300; i++) {
                    const x = Math.random() * 512;
                    const y = Math.random() * 512;
                    const r = Math.random() * 4 + 1;
                    ctx.beginPath();
                    ctx.arc(x, y, r, 0, Math.PI * 2);
                    ctx.fillStyle = `rgba(134, 239, 172, ${Math.random() * 0.5 + 0.2})`;
                    ctx.fill();
                }

                // Small flower dots
                for (let i = 0; i < 20; i++) {
                    const x = Math.random() * 512;
                    const y = Math.random() * 512;
                    ctx.beginPath();
                    ctx.arc(x, y, 3, 0, Math.PI * 2);
                    const colors = ['#fca5a5', '#fde68a', '#c4b5fd', '#fdba74', '#93c5fd'];
                    ctx.fillStyle = colors[Math.floor(Math.random() * colors.length)];
                    ctx.fill();
                }

                const texture = new THREE.CanvasTexture(canvas);
                texture.wrapS = THREE.RepeatWrapping;
                texture.wrapT = THREE.RepeatWrapping;
                texture.repeat.set(4, 4);
                texture.colorSpace = THREE.SRGBColorSpace;
                return texture;
            }

            _roundRect(ctx, x, y, w, h, r) {
                ctx.beginPath();
                ctx.moveTo(x + r, y);
                ctx.lineTo(x + w - r, y);
                ctx.quadraticCurveTo(x + w, y, x + w, y + r);
                ctx.lineTo(x + w, y + h - r);
                ctx.quadraticCurveTo(x + w, y + h, x + w - r, y + h);
                ctx.lineTo(x + r, y + h);
                ctx.quadraticCurveTo(x, y + h, x, y + h - r);
                ctx.lineTo(x, y + r);
                ctx.quadraticCurveTo(x, y, x + r, y);
                ctx.closePath();
            }

            createStarTexture() {
                const canvas = document.createElement('canvas');
                canvas.width = this.size;
                canvas.height = this.size;
                const ctx = canvas.getContext('2d');

                // Soft gradient background
                const grad = ctx.createRadialGradient(
                    this.size / 2, this.size / 2, 0,
                    this.size / 2, this.size / 2, this.size * 0.7
                );
                grad.addColorStop(0, '#ffffff');
                grad.addColorStop(1, '#fdf2f8');
                ctx.fillStyle = grad;
                this._roundRect(ctx, 0, 0, this.size, this.size, 40);
                ctx.fill();

                // Decorative border
                ctx.strokeStyle = '#f9a8d4';
                ctx.lineWidth = 12;
                this._roundRect(ctx, 16, 16, this.size - 32, this.size - 32, 30);
                ctx.stroke();

                // Star emoji
                ctx.font = `${this.size * 0.4}px serif`;
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText('‚≠ê', this.size / 2, this.size / 2);

                const texture = new THREE.CanvasTexture(canvas);
                texture.colorSpace = THREE.SRGBColorSpace;
                return texture;
            }
        }

        // ==========================================
        // CLASS: ParticleSystem (Stars)
        // ==========================================
        class ParticleSystem {
            constructor(scene) {
                this.scene = scene;
                this._starTexture = this._createStarTexture();
            }

            _createStarTexture() {
                const canvas = document.createElement('canvas');
                canvas.width = 64;
                canvas.height = 64;
                const ctx = canvas.getContext('2d');
                this._drawStar(ctx, 32, 32, 5, 28, 12);
                return new THREE.CanvasTexture(canvas);
            }

            burst(position) {
                const count = 40;
                const colors = [0xf472b6, 0xc084fc, 0x60a5fa, 0x34d399, 0xfbbf24, 0xfb923c];

                const geometry = new THREE.BufferGeometry();
                const positions = new Float32Array(count * 3);
                const colorArr = new Float32Array(count * 3);

                for (let i = 0; i < count; i++) {
                    positions[i * 3] = position.x;
                    positions[i * 3 + 1] = position.y;
                    positions[i * 3 + 2] = position.z;

                    const c = new THREE.Color(colors[Math.floor(Math.random() * colors.length)]);
                    colorArr[i * 3] = c.r;
                    colorArr[i * 3 + 1] = c.g;
                    colorArr[i * 3 + 2] = c.b;
                }

                geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
                geometry.setAttribute('color', new THREE.BufferAttribute(colorArr, 3));

                const material = new THREE.PointsMaterial({
                    size: 0.3,
                    map: this._starTexture,
                    vertexColors: true,
                    transparent: true,
                    opacity: 1,
                    depthWrite: false,
                    blending: THREE.AdditiveBlending,
                    sizeAttenuation: true,
                });

                const points = new THREE.Points(geometry, material);
                this.scene.add(points);

                // Velocity per particle
                const velocities = [];
                for (let i = 0; i < count; i++) {
                    velocities.push({
                        x: (Math.random() - 0.5) * 6,
                        y: Math.random() * 4 + 2,
                        z: (Math.random() - 0.5) * 6,
                    });
                }

                const duration = 1.2;
                const startTime = performance.now() / 1000;
                const posAttr = geometry.getAttribute('position');

                const animateParticles = () => {
                    const elapsed = performance.now() / 1000 - startTime;
                    const t = Math.min(elapsed / duration, 1);

                    for (let i = 0; i < count; i++) {
                        posAttr.array[i * 3] = position.x + velocities[i].x * t;
                        posAttr.array[i * 3 + 1] = position.y + velocities[i].y * t - 4.9 * t * t;
                        posAttr.array[i * 3 + 2] = position.z + velocities[i].z * t;
                    }
                    posAttr.needsUpdate = true;
                    material.opacity = 1 - t;

                    if (t < 1) {
                        requestAnimationFrame(animateParticles);
                    } else {
                        this.scene.remove(points);
                        geometry.dispose();
                        material.dispose();
                    }
                };

                animateParticles();
            }

            _drawStar(ctx, cx, cy, spikes, outerR, innerR) {
                let rot = Math.PI / 2 * 3;
                const step = Math.PI / spikes;

                ctx.beginPath();
                ctx.moveTo(cx, cy - outerR);

                for (let i = 0; i < spikes; i++) {
                    let x = cx + Math.cos(rot) * outerR;
                    let y = cy + Math.sin(rot) * outerR;
                    ctx.lineTo(x, y);
                    rot += step;

                    x = cx + Math.cos(rot) * innerR;
                    y = cy + Math.sin(rot) * innerR;
                    ctx.lineTo(x, y);
                    rot += step;
                }

                ctx.lineTo(cx, cy - outerR);
                ctx.closePath();
                ctx.fillStyle = '#ffffff';
                ctx.fill();
            }

            dispose() {
                this._starTexture.dispose();
            }
        }

        // ==========================================
        // CLASS: HijaiyahCube
        // ==========================================
        class HijaiyahCube {
            constructor(scene, textures) {
                this.scene = scene;
                this.textures = textures;
                this.currentFace = 0;
                this.isAnimating = false;
                this.materials = [];

                this._createCube();
            }

            _createCube() {
                // RoundedBoxGeometry(width, height, depth, segments, radius)
                this.geometry = new RoundedBoxGeometry(2.4, 2.4, 2.4, 4, 0.2);

                // BoxGeometry material order: [+X, -X, +Y, -Y, +Z, -Z]
                // We want our letter order to map as:
                //   Letter 0 (Alif) ‚Üí +Z face (front, material index 4)
                //   Letter 1 (Ba)   ‚Üí +X face (right, material index 0)
                //   Letter 2 (Ta)   ‚Üí -Z face (back, material index 5)
                //   Letter 3 (Tsa)  ‚Üí -X face (left, material index 1)
                //   Letter 4 (Jim)  ‚Üí +Y face (top, material index 2)
                //   Letter 5 (Kha)  ‚Üí -Y face (bottom, material index 3)
                const createMat = (tex) => new THREE.MeshStandardMaterial({
                    map: tex,
                    roughness: 0.35,
                    metalness: 0.05,
                });

                // Rearrange: [+X=Ba, -X=Tsa, +Y=Kha, -Y=Jim, +Z=Alif, -Z=Ta]
                // Note: x=-œÄ/2 rotation shows -Y face, x=œÄ/2 shows +Y face
                this.materials = [
                    createMat(this.textures[1]), // +X ‚Üí Ba
                    createMat(this.textures[3]), // -X ‚Üí Tsa
                    createMat(this.textures[5]), // +Y ‚Üí Kha (shown by x=œÄ/2)
                    createMat(this.textures[4]), // -Y ‚Üí Jim (shown by x=-œÄ/2)
                    createMat(this.textures[0]), // +Z ‚Üí Alif (front)
                    createMat(this.textures[2]), // -Z ‚Üí Ta
                ];

                this.mesh = new THREE.Mesh(this.geometry, this.materials);
                this.mesh.position.set(0, 1.8, 0);
                this.mesh.castShadow = false;
                this.mesh.receiveShadow = false;
                this.scene.add(this.mesh);

                // Gentle idle float
                this._startIdleAnimation();
            }

            _startIdleAnimation() {
                gsap.to(this.mesh.position, {
                    y: 2.1,
                    duration: 2,
                    ease: 'sine.inOut',
                    yoyo: true,
                    repeat: -1,
                });

                gsap.to(this.mesh.rotation, {
                    y: Math.PI * 0.05,
                    duration: 3,
                    ease: 'sine.inOut',
                    yoyo: true,
                    repeat: -1,
                });
            }

            squashAndStretch() {
                if (this.isAnimating) return;
                this.isAnimating = true;

                const tl = gsap.timeline({
                    onComplete: () => { this.isAnimating = false; }
                });

                tl.to(this.mesh.scale, {
                    x: 1.25,
                    y: 0.7,
                    z: 1.25,
                    duration: 0.12,
                    ease: 'power2.in',
                })
                    .to(this.mesh.scale, {
                        x: 0.85,
                        y: 1.35,
                        z: 0.85,
                        duration: 0.15,
                        ease: 'power2.out',
                    })
                    .to(this.mesh.scale, {
                        x: 1.08,
                        y: 0.92,
                        z: 1.08,
                        duration: 0.12,
                        ease: 'sine.inOut',
                    })
                    .to(this.mesh.scale, {
                        x: 1,
                        y: 1,
                        z: 1,
                        duration: 0.2,
                        ease: 'elastic.out(1, 0.4)',
                    });

                return tl;
            }

            rotateTo(faceIndex) {
                if (this.isAnimating) return;
                this.isAnimating = true;
                this.currentFace = faceIndex;

                // Rotation to show each letter's face toward camera:
                //   Letter 0 (Alif) ‚Üí +Z face ‚Üí rotation (0, 0)
                //   Letter 1 (Ba)   ‚Üí +X face ‚Üí rotation (0, -œÄ/2)
                //   Letter 2 (Ta)   ‚Üí -Z face ‚Üí rotation (0, œÄ)
                //   Letter 3 (Tsa)  ‚Üí -X face ‚Üí rotation (0, œÄ/2)
                //   Letter 4 (Jim)  ‚Üí +Y face ‚Üí rotation (-œÄ/2, 0)
                //   Letter 5 (Kha)  ‚Üí -Y face ‚Üí rotation (œÄ/2, 0)
                const faceRotations = [
                    { x: 0, y: 0 },                // Alif on +Z (front)
                    { x: 0, y: -Math.PI / 2 },     // Ba on +X (right)
                    { x: 0, y: Math.PI },          // Ta on -Z (back)
                    { x: 0, y: Math.PI / 2 },      // Tsa on -X (left)
                    { x: -Math.PI / 2, y: 0 },     // Jim on +Y (top)
                    { x: Math.PI / 2, y: 0 },      // Kha on -Y (bottom)
                ];

                const target = faceRotations[faceIndex];

                // Kill idle rotation before animating to new face
                gsap.killTweensOf(this.mesh.rotation);

                gsap.to(this.mesh.rotation, {
                    x: target.x,
                    y: target.y,
                    duration: 0.8,
                    ease: 'back.out(1.7)',
                    onComplete: () => {
                        this.isAnimating = false;
                        // Restart gentle idle on the new y rotation
                        gsap.to(this.mesh.rotation, {
                            y: target.y + Math.PI * 0.05,
                            duration: 3,
                            ease: 'sine.inOut',
                            yoyo: true,
                            repeat: -1,
                        });
                    }
                });
            }

            getMesh() {
                return this.mesh;
            }

            updateFaces(newTextures, starTexture) {
                // Dispose old materials
                this.materials.forEach(m => {
                    if (m.map) m.map.dispose();
                    m.dispose();
                });

                this.textures = newTextures;
                const createMat = (tex) => new THREE.MeshStandardMaterial({
                    map: tex, roughness: 0.35, metalness: 0.05,
                });

                // Pad to 6 with star textures if needed
                const padded = [...newTextures];
                while (padded.length < 6) padded.push(starTexture);

                // Same face mapping as _createCube
                this.materials = [
                    createMat(padded[1]), // +X
                    createMat(padded[3]), // -X
                    createMat(padded[5]), // +Y (shown by x=œÄ/2)
                    createMat(padded[4]), // -Y (shown by x=-œÄ/2)
                    createMat(padded[0]), // +Z (front)
                    createMat(padded[2]), // -Z
                ];

                this.mesh.material = this.materials;

                // Reset rotation to front face
                gsap.killTweensOf(this.mesh.rotation);
                this.mesh.rotation.set(0, 0, 0);
                this.currentFace = 0;
                this.isAnimating = false;

                // Restart idle animation
                gsap.to(this.mesh.rotation, {
                    y: Math.PI * 0.05,
                    duration: 3,
                    ease: 'sine.inOut',
                    yoyo: true,
                    repeat: -1,
                });
            }

            dispose() {
                gsap.killTweensOf(this.mesh.scale);
                gsap.killTweensOf(this.mesh.position);
                gsap.killTweensOf(this.mesh.rotation);
                this.geometry.dispose();
                this.materials.forEach(m => {
                    if (m.map) m.map.dispose();
                    m.dispose();
                });
                this.scene.remove(this.mesh);
            }
        }

        // ==========================================
        // CLASS: Game (Main Controller)
        // ==========================================
        class Game {
            constructor() {
                this.canvas = document.getElementById('game-canvas');
                this.loadingScreen = document.getElementById('loading-screen');
                this.loadingBar = document.getElementById('loading-bar');
                this.uiOverlay = document.getElementById('ui-overlay');
                this.letterDisplay = document.getElementById('letter-display');
                this.letterArabic = document.getElementById('letter-arabic');
                this.letterName = document.getElementById('letter-name');
                this.celebration = document.getElementById('celebration');
                this.celebrationText = document.getElementById('celebration-text');
                this.progressDotsContainer = document.getElementById('progress-dots');
                this.groupIndicator = document.getElementById('group-indicator');
                this.groupLabel = document.getElementById('group-label');
                this.overallProgress = document.getElementById('overall-progress');
                this.overallProgressFill = document.getElementById('overall-progress-fill');
                this.groupFlash = document.getElementById('group-flash');
                this.groupFlashText = document.getElementById('group-flash-text');

                this.currentIndex = 0;
                this.currentGroup = 0;
                this.groupLetters = getGroupLetters(0);
                this.visitedFaces = new Set();
                this.totalVisited = 0;
                this.isStarted = false;

                this.raycaster = new THREE.Raycaster();
                this.pointer = new THREE.Vector2();

                // Sound
                this.soundManager = new SoundManager();
                this.soundManager._preloadVoices();

                // Challenge mode state
                this.challengeMode = false;
                this.challengeIndex = 0;
                this.challengeOverlay = document.getElementById('challenge-overlay');
                this.challengeProgressEl = document.getElementById('challenge-progress');
                this.challengeProgressFill = document.getElementById('challenge-progress-fill');
                this.challengePromptName = document.getElementById('challenge-prompt-name');
                this.challengeFeedback = document.getElementById('challenge-feedback');
                this.challengeChoicesEl = document.getElementById('challenge-choices');
                this.challengeLocked = false;

                // Draw mode state
                this.drawMode = false;
                this.drawIndex = 0;
                this.drawOverlay = document.getElementById('draw-overlay');
                this.drawProgressEl = document.getElementById('draw-progress');
                this.drawProgressFill = document.getElementById('draw-progress-fill');
                this.drawPromptName = document.getElementById('draw-prompt-name');
                this.drawReference = document.getElementById('draw-reference');
                this.drawFeedback = document.getElementById('draw-feedback');
                this.drawCanvas = document.getElementById('draw-canvas');
                this.drawCtx = this.drawCanvas.getContext('2d');
                this.isDrawing = false;
                this.drawLocked = false;

                // Sort mode state
                this.sortMode = false;
                this.sortOverlay = document.getElementById('sort-overlay');
                this.sortTargetsEl = document.getElementById('sort-targets');
                this.sortGroundEl = document.getElementById('sort-ground');
                this.sortProgress = document.getElementById('sort-progress');
                this.sortProgressFill = document.getElementById('sort-progress-fill');
                this.sortFeedback = document.getElementById('sort-feedback');
                this.sortedCount = 0;
                this._dragApple = null;
                this._dragOffsetX = 0;
                this._dragOffsetY = 0;

                this._init();
            }

            _init() {
                this._setupRenderer();
                this._setupScene();
                this._setupCamera();
                this._setupControls();
                this._setupLighting();
                this._generateTextures();
                this._createGround();
                this._createCube();
                this._createParticleSystem();
                this._createProgressDots();
                this._setupEvents();
                this._showLetter(this.currentIndex);

                // Simulate loading (textures are canvas-generated, so instant)
                this._simulateLoading();

                this._animate();
            }

            _setupRenderer() {
                this.renderer = new THREE.WebGLRenderer({
                    canvas: this.canvas,
                    antialias: true,
                    alpha: false,
                });
                this.renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
                this.renderer.setSize(window.innerWidth, window.innerHeight);
                this.renderer.setClearColor(0xfdf2f8);
                this.renderer.outputColorSpace = THREE.SRGBColorSpace;
                this.renderer.toneMapping = THREE.ACESFilmicToneMapping;
                this.renderer.toneMappingExposure = 1.0;
            }

            _setupScene() {
                this.scene = new THREE.Scene();
                this.scene.fog = new THREE.Fog(0xfdf2f8, 12, 30);
            }

            _setupCamera() {
                this.camera = new THREE.PerspectiveCamera(
                    45,
                    window.innerWidth / window.innerHeight,
                    0.1,
                    100
                );
                this.camera.position.set(0, 3, 6.5);
                this.camera.lookAt(0, 1.5, 0);
            }

            _setupControls() {
                this.controls = new OrbitControls(this.camera, this.canvas);
                this.controls.enableDamping = true;
                this.controls.dampingFactor = 0.08;
                this.controls.enablePan = false;
                this.controls.minDistance = 4;
                this.controls.maxDistance = 10;
                this.controls.maxPolarAngle = Math.PI * 0.6;
                this.controls.minPolarAngle = Math.PI * 0.2;
                this.controls.target.set(0, 1.5, 0);
                this.controls.autoRotate = false;
                this.controls.enableZoom = true;
            }

            _setupLighting() {
                // Hemisphere light for soft toy-like illumination
                const hemiLight = new THREE.HemisphereLight(0xfce7f3, 0xd1fae5, 1.2);
                hemiLight.position.set(0, 20, 0);
                this.scene.add(hemiLight);

                // Soft directional for slight definition (no harsh shadows)
                const dirLight = new THREE.DirectionalLight(0xffffff, 0.6);
                dirLight.position.set(5, 10, 5);
                dirLight.castShadow = false;
                this.scene.add(dirLight);

                // Ambient fill
                const ambLight = new THREE.AmbientLight(0xede9fe, 0.4);
                this.scene.add(ambLight);
            }

            _generateTextures() {
                this.texGen = new TextureGenerator();
                this.starTexture = this.texGen.createStarTexture();
                this.letterTextures = this.groupLetters.map(l => this.texGen.createLetterTexture(l));
                this.grassTexture = this.texGen.createGrassTexture();
            }

            _createGround() {
                const groundGeo = new THREE.CircleGeometry(12, 64);
                const groundMat = new THREE.MeshStandardMaterial({
                    map: this.grassTexture,
                    roughness: 0.9,
                    metalness: 0,
                });

                this.ground = new THREE.Mesh(groundGeo, groundMat);
                this.ground.rotation.x = -Math.PI / 2;
                this.ground.position.y = 0;
                this.scene.add(this.ground);

                // Background clouds (soft spheres)
                this._createClouds();
            }

            _createClouds() {
                const cloudMat = new THREE.MeshStandardMaterial({
                    color: 0xffffff,
                    roughness: 1,
                    metalness: 0,
                    transparent: true,
                    opacity: 0.6,
                });

                const cloudPositions = [
                    [-6, 6, -8],
                    [5, 7, -10],
                    [-3, 5.5, -12],
                    [8, 6.5, -9],
                ];

                cloudPositions.forEach(([x, y, z]) => {
                    const group = new THREE.Group();
                    const sizes = [
                        { s: 1.2, ox: 0, oy: 0 },
                        { s: 0.9, ox: 1, oy: 0.2 },
                        { s: 0.8, ox: -0.9, oy: 0.1 },
                        { s: 0.6, ox: 1.5, oy: -0.1 },
                    ];
                    sizes.forEach(({ s, ox, oy }) => {
                        const geo = new THREE.SphereGeometry(s, 16, 16);
                        const cloud = new THREE.Mesh(geo, cloudMat);
                        cloud.position.set(ox, oy, 0);
                        group.add(cloud);
                    });
                    group.position.set(x, y, z);
                    this.scene.add(group);

                    // Gentle cloud drift
                    gsap.to(group.position, {
                        x: x + 1.5,
                        duration: 8 + Math.random() * 4,
                        ease: 'sine.inOut',
                        yoyo: true,
                        repeat: -1,
                    });
                });
            }

            _createCube() {
                this.cube = new HijaiyahCube(this.scene, this.letterTextures);
            }

            _createParticleSystem() {
                this.particleSystem = new ParticleSystem(this.scene);
            }

            _createProgressDots() {
                this.progressDotsContainer.innerHTML = '';
                for (let i = 0; i < this.groupLetters.length; i++) {
                    const dot = document.createElement('div');
                    dot.className = 'dot';
                    if (i === 0) dot.classList.add('active');
                    this.progressDotsContainer.appendChild(dot);
                }
            }

            _updateProgressDots() {
                const dots = this.progressDotsContainer.querySelectorAll('.dot');
                dots.forEach((dot, i) => {
                    dot.classList.toggle('active', this.visitedFaces.has(i));
                });
            }

            _updateOverallProgress() {
                const pct = (this.totalVisited / ALL_HIJAIYAH.length) * 100;
                this.overallProgressFill.style.width = pct + '%';
            }

            _updateGroupLabel() {
                const letters = this.groupLetters.map(l => l.arabic).join(' ');
                this.groupLabel.textContent = `${this.currentGroup + 1}/${TOTAL_GROUPS} ‚Ä¢ ${letters}`;
            }

            _showLetter(index) {
                const letter = this.groupLetters[index];
                if (!letter) return;
                this.letterArabic.textContent = letter.arabic;
                this.letterName.textContent = letter.name;
                this.letterArabic.style.color = letter.accent;

                // Pop animation
                this.letterDisplay.classList.remove('show');
                requestAnimationFrame(() => {
                    requestAnimationFrame(() => {
                        this.letterDisplay.classList.add('show');
                    });
                });

                if (!this.visitedFaces.has(index)) {
                    this.visitedFaces.add(index);
                    this.totalVisited++;
                    this._updateOverallProgress();
                }
                this._updateProgressDots();
            }

            _loadGroup(groupIndex) {
                this.currentGroup = groupIndex;
                this.groupLetters = getGroupLetters(groupIndex);
                this.currentIndex = 0;
                this.visitedFaces.clear();

                // Generate new textures
                const newTextures = this.groupLetters.map(l => this.texGen.createLetterTexture(l));
                this.letterTextures = newTextures;

                // Update cube faces
                this.cube.updateFaces(newTextures, this.starTexture);

                // Update UI
                this._createProgressDots();
                this._updateGroupLabel();
                this._showLetter(0);

                // Entrance animation
                gsap.from(this.cube.getMesh().scale, {
                    x: 0.5, y: 0.5, z: 0.5,
                    duration: 0.6,
                    ease: 'elastic.out(1, 0.5)',
                });
            }

            _simulateLoading() {
                let progress = 0;
                const interval = setInterval(() => {
                    progress += Math.random() * 25 + 10;
                    if (progress >= 100) {
                        progress = 100;
                        clearInterval(interval);
                        setTimeout(() => this._onLoadingComplete(), 400);
                    }
                    this.loadingBar.style.width = progress + '%';
                }, 200);
            }

            _onLoadingComplete() {
                this.loadingScreen.classList.add('hidden');
                this.uiOverlay.classList.add('visible');
                this.groupIndicator.classList.add('visible');
                this.overallProgress.classList.add('visible');
                this.isStarted = true;

                this._updateGroupLabel();

                // Entrance animation for the cube
                gsap.from(this.cube.getMesh().scale, {
                    x: 0, y: 0, z: 0,
                    duration: 0.8,
                    ease: 'elastic.out(1, 0.5)',
                    delay: 0.3,
                });

                // Init sound on first user gesture
                const initSound = () => {
                    this.soundManager.init();
                    this.soundManager.startBgMusic();
                    document.removeEventListener('click', initSound);
                    document.removeEventListener('touchstart', initSound);
                };
                document.addEventListener('click', initSound);
                document.addEventListener('touchstart', initSound);
            }

            _setupEvents() {
                // Resize
                window.addEventListener('resize', () => this._onResize());

                // Mouse click
                this.canvas.addEventListener('click', (e) => this._onPointerDown(e));

                // Touch
                this.canvas.addEventListener('touchstart', (e) => {
                    e.preventDefault();
                    if (e.touches.length > 0) {
                        this._onPointerDown(e.touches[0]);
                    }
                }, { passive: false });

                // Buttons
                document.getElementById('btn-next').addEventListener('click', (e) => {
                    e.stopPropagation();
                    this._nextLetter();
                });
                document.getElementById('btn-tap').addEventListener('click', (e) => {
                    e.stopPropagation();
                    this._tapCube();
                });
                document.getElementById('btn-restart').addEventListener('click', (e) => {
                    e.stopPropagation();
                    this._restart();
                });

                // Sound toggle
                const btnSound = document.getElementById('btn-sound');
                btnSound.addEventListener('click', (e) => {
                    e.stopPropagation();
                    this.soundManager.init();
                    const muted = this.soundManager.toggleMute();
                    btnSound.textContent = muted ? 'üîá' : 'üîä';
                    btnSound.classList.toggle('muted', muted);
                    if (!muted && !this.soundManager.bgMusicStarted) {
                        this.soundManager.startBgMusic();
                    }
                    if (muted) {
                        this.soundManager.stopBgMusic();
                    }
                });

                // Challenge mode toggle
                document.getElementById('btn-mode').addEventListener('click', (e) => {
                    e.stopPropagation();
                    this.soundManager.init();
                    this._startChallenge();
                });
                document.getElementById('btn-exit-challenge').addEventListener('click', (e) => {
                    e.stopPropagation();
                    this._exitChallenge();
                });
                document.getElementById('challenge-listen-btn').addEventListener('click', (e) => {
                    e.stopPropagation();
                    this.soundManager.init();
                    const letter = ALL_HIJAIYAH[this.challengeIndex];
                    if (letter) this.soundManager.playLetterVoice(letter);
                });

                // Draw mode toggle
                document.getElementById('btn-draw-mode').addEventListener('click', (e) => {
                    e.stopPropagation();
                    this.soundManager.init();
                    this._startDraw();
                });
                document.getElementById('btn-exit-draw').addEventListener('click', (e) => {
                    e.stopPropagation();
                    this._exitDraw();
                });
                document.getElementById('btn-draw-clear').addEventListener('click', (e) => {
                    e.stopPropagation();
                    this._clearDrawCanvas();
                });
                document.getElementById('btn-draw-check').addEventListener('click', (e) => {
                    e.stopPropagation();
                    this._checkDrawing();
                });

                // Drawing canvas events
                const dc = this.drawCanvas;
                dc.addEventListener('mousedown', (e) => this._onDrawStart(e));
                dc.addEventListener('mousemove', (e) => this._onDrawMove(e));
                dc.addEventListener('mouseup', () => this._onDrawEnd());
                dc.addEventListener('mouseleave', () => this._onDrawEnd());
                dc.addEventListener('touchstart', (e) => { e.preventDefault(); this._onDrawStart(e.touches[0]); }, { passive: false });
                dc.addEventListener('touchmove', (e) => { e.preventDefault(); this._onDrawMove(e.touches[0]); }, { passive: false });
                dc.addEventListener('touchend', (e) => { e.preventDefault(); this._onDrawEnd(); }, { passive: false });

                // Sort legend toggle
                document.getElementById('btn-sort-legend').addEventListener('click', (e) => {
                    e.stopPropagation();
                    this.soundManager.init();
                    this.soundManager.playClick();
                    document.getElementById('legend-modal').classList.add('show');
                });
                document.getElementById('btn-legend-close').addEventListener('click', (e) => {
                    e.stopPropagation();
                    this.soundManager.playClick();
                    document.getElementById('legend-modal').classList.remove('show');
                });

                // Sort mode toggle
                document.getElementById('btn-sort-mode').addEventListener('click', (e) => {
                    e.stopPropagation();
                    this.soundManager.init();
                    this._startSort();
                });
                document.getElementById('btn-exit-sort').addEventListener('click', (e) => {
                    e.stopPropagation();
                    this._exitSort();
                });
            }

            _onPointerDown(event) {
                if (!this.isStarted) return;

                const rect = this.canvas.getBoundingClientRect();
                const clientX = event.clientX || event.pageX;
                const clientY = event.clientY || event.pageY;

                this.pointer.x = ((clientX - rect.left) / rect.width) * 2 - 1;
                this.pointer.y = -((clientY - rect.top) / rect.height) * 2 + 1;

                this.raycaster.setFromCamera(this.pointer, this.camera);
                const intersects = this.raycaster.intersectObject(this.cube.getMesh());

                if (intersects.length > 0) {
                    this._onCubeInteract(intersects[0].point);
                }
            }

            _onCubeInteract(hitPoint) {
                // Squash and stretch
                this.cube.squashAndStretch();

                // Particle burst at hit point
                this.particleSystem.burst(hitPoint);

                const currentLetter = this.groupLetters[this.currentIndex];

                // iOS Safari: voice MUST be called synchronously from user gesture.
                // On iOS, speak immediately (no setTimeout).
                // On desktop, delay 350ms so voice doesn't clash with pop SFX.
                const isIOS = this.soundManager._isIOS;

                this.soundManager.playPop();
                setTimeout(() => this.soundManager.playSparkle(), 120);

                if (currentLetter) {
                    if (isIOS) {
                        // Synchronous call within gesture ‚Äî required by iOS
                        this.soundManager.playLetterVoice(currentLetter);
                    } else {
                        setTimeout(() => this.soundManager.playLetterVoice(currentLetter), 350);
                    }
                }

                // Show letter display with pop
                this._showLetter(this.currentIndex);
            }

            _tapCube() {
                if (!this.isStarted || this.cube.isAnimating) return;
                const pos = this.cube.getMesh().position.clone();
                this._onCubeInteract(pos);
            }

            _nextLetter() {
                if (!this.isStarted || this.cube.isAnimating) return;

                this.soundManager.playClick();
                const groupSize = this.groupLetters.length;
                this.currentIndex = (this.currentIndex + 1) % groupSize;

                // Group complete ‚Üí advance to next group or final celebration
                if (this.visitedFaces.size === groupSize && this.currentIndex === 0) {
                    if (this.currentGroup < TOTAL_GROUPS - 1) {
                        // Show group flash + advance
                        this._showGroupFlash();
                    } else {
                        // All 28 letters done!
                        this._showCelebration();
                    }
                    return;
                }

                // No voice on next letter ‚Äî only SFX
                this.soundManager.playWhoosh();
                this.cube.rotateTo(this.currentIndex);
                this._showLetter(this.currentIndex);

                // Small burst for encouragement
                const cubePos = this.cube.getMesh().position.clone();
                cubePos.y += 1.5;
                setTimeout(() => {
                    this.particleSystem.burst(cubePos);
                    this.soundManager.playSparkle();
                }, 400);
            }

            _showGroupFlash() {
                const nextGroup = this.currentGroup + 1;
                const nextLetters = getGroupLetters(nextGroup);
                this.groupFlashText.textContent = `‚≠ê Group ${nextGroup + 1}: ${nextLetters.map(l => l.arabic).join(' ')}`;
                this.groupFlash.classList.add('show');

                this.soundManager.playCelebration();

                // Particles
                for (let i = 0; i < 2; i++) {
                    setTimeout(() => {
                        this.particleSystem.burst(
                            new THREE.Vector3((Math.random() - 0.5) * 3, 2.5, (Math.random() - 0.5) * 3)
                        );
                    }, i * 250);
                }

                // Auto-advance after 2 seconds
                setTimeout(() => {
                    this.groupFlash.classList.remove('show');
                    this._loadGroup(nextGroup);
                }, 2000);
            }

            _showCelebration() {
                this.celebrationText.innerHTML = 'üåü Amazing! üåü<br>You learned all 28 letters!';
                this.celebration.classList.add('show');

                this.soundManager.playCelebration();
                this.soundManager.stopBgMusic();

                for (let i = 0; i < 5; i++) {
                    setTimeout(() => {
                        this.particleSystem.burst(
                            new THREE.Vector3(
                                (Math.random() - 0.5) * 4,
                                2 + Math.random() * 2,
                                (Math.random() - 0.5) * 4
                            )
                        );
                    }, i * 250);
                }
            }

            _restart() {
                this.celebration.classList.remove('show');
                this.totalVisited = 0;
                this._loadGroup(0);
                this._updateOverallProgress();
                this.soundManager.playClick();
                this.soundManager.startBgMusic();
            }

            // ==========================================
            // CHALLENGE MODE
            // ==========================================
            _startChallenge() {
                this.challengeMode = true;
                this.challengeIndex = 0;
                this.challengeOverlay.classList.add('show');
                this.soundManager.playSparkle();
                this._loadChallengeQuestion(0);

                // Update mode button
                const btn = document.getElementById('btn-mode');
                btn.innerHTML = '<span class="mode-icon">üé≤</span> Explore';
            }

            _exitChallenge() {
                this.challengeMode = false;
                this.challengeOverlay.classList.remove('show');
                this.challengeFeedback.textContent = '';
                this.challengeFeedback.className = 'challenge-feedback';
                this.soundManager.playClick();

                // Restore mode button
                const btn = document.getElementById('btn-mode');
                btn.innerHTML = '<span class="mode-icon">‚úèÔ∏è</span> Challenge';
            }

            _loadChallengeQuestion(index) {
                this.challengeIndex = index;
                this.challengeLocked = false;
                const letter = ALL_HIJAIYAH[index];

                // Update progress
                this.challengeProgressEl.textContent = `${index + 1} / ${ALL_HIJAIYAH.length}`;
                this.challengeProgressFill.style.width = `${(index / ALL_HIJAIYAH.length) * 100}%`;

                // Clear feedback
                this.challengeFeedback.textContent = '';
                this.challengeFeedback.className = 'challenge-feedback';

                // Generate 4 choices (1 correct + 3 random wrong)
                const wrongPool = ALL_HIJAIYAH.filter((_, i) => i !== index);
                const shuffled = wrongPool.sort(() => Math.random() - 0.5);
                const choices = [letter, shuffled[0], shuffled[1], shuffled[2]];
                // Shuffle choices
                for (let i = choices.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [choices[i], choices[j]] = [choices[j], choices[i]];
                }

                // Render choice buttons
                this.challengeChoicesEl.innerHTML = '';
                choices.forEach(ch => {
                    const btn = document.createElement('div');
                    btn.className = 'challenge-choice';
                    btn.textContent = ch.arabic;
                    btn.dataset.name = ch.name;
                    btn.addEventListener('click', () => this._onChallengeAnswer(btn, ch, letter));
                    this.challengeChoicesEl.appendChild(btn);
                });
            }

            _onChallengeAnswer(btn, chosen, correct) {
                if (this.challengeLocked) return;

                if (chosen === correct) {
                    // ‚úÖ CORRECT
                    this.challengeLocked = true;
                    btn.classList.add('correct-flash');
                    this.challengeFeedback.textContent = '‚úÖ Kamu benar, ayo lanjut!';
                    this.challengeFeedback.className = 'challenge-feedback correct';
                    this.soundManager.playSparkle();
                    this.soundManager.playLetterVoice(correct);

                    // Auto-advance after 1.5s
                    setTimeout(() => {
                        if (this.challengeIndex < ALL_HIJAIYAH.length - 1) {
                            this._loadChallengeQuestion(this.challengeIndex + 1);
                        } else {
                            this._challengeComplete();
                        }
                    }, 1500);
                } else {
                    // ‚ùå WRONG
                    btn.classList.add('wrong-flash');
                    this.challengeFeedback.textContent = '‚ùå Kamu salah, ayo coba lagi!';
                    this.challengeFeedback.className = 'challenge-feedback wrong';
                    this.soundManager.playBuzz();

                    // Play the chosen letter's voice so the learner hears what they tapped
                    setTimeout(() => this.soundManager.playLetterVoice(chosen), 350);

                    // Remove shake class after animation
                    setTimeout(() => btn.classList.remove('wrong-flash'), 500);
                }
            }

            _challengeComplete() {
                this.challengeOverlay.classList.remove('show');
                this.challengeProgressFill.style.width = '100%';

                // Show celebration with different text
                this.celebrationText.innerHTML = 'üåü Amazing! üåü<br>You completed all 28 letters!';
                this.celebration.classList.add('show');
                this.soundManager.playCelebration();

                for (let i = 0; i < 5; i++) {
                    setTimeout(() => {
                        this.particleSystem.burst(
                            new THREE.Vector3(
                                (Math.random() - 0.5) * 4,
                                2 + Math.random() * 2,
                                (Math.random() - 0.5) * 4
                            )
                        );
                    }, i * 250);
                }

                // Restore mode button and state
                this.challengeMode = false;
                const modeBtn = document.getElementById('btn-mode');
                modeBtn.innerHTML = '<span class="mode-icon">‚úèÔ∏è</span> Challenge';
            }

            // ==========================================
            // DRAW MODE
            // ==========================================
            _startDraw() {
                this.drawMode = true;
                this.drawIndex = 0;
                this.drawOverlay.classList.add('show');
                this.soundManager.playSparkle();
                this._loadDrawQuestion(0);
            }

            _exitDraw() {
                this.drawMode = false;
                this.drawOverlay.classList.remove('show');
                this.drawFeedback.textContent = '';
                this.drawFeedback.className = 'challenge-feedback';
                this.soundManager.playClick();
            }

            _loadDrawQuestion(index) {
                this.drawIndex = index;
                this.drawLocked = false;
                const letter = ALL_HIJAIYAH[index];

                // Progress
                this.drawProgressEl.textContent = `${index + 1} / ${ALL_HIJAIYAH.length}`;
                this.drawProgressFill.style.width = `${(index / ALL_HIJAIYAH.length) * 100}%`;

                // Prompt
                this.drawPromptName.textContent = letter.name;
                this.drawReference.textContent = letter.arabic;

                // Clear feedback
                this.drawFeedback.textContent = '';
                this.drawFeedback.className = 'challenge-feedback';

                // Clear canvas
                this._clearDrawCanvas();
            }

            _clearDrawCanvas() {
                const c = this.drawCanvas;
                const ctx = this.drawCtx;
                ctx.clearRect(0, 0, c.width, c.height);
                // White background
                ctx.fillStyle = '#ffffff';
                ctx.fillRect(0, 0, c.width, c.height);
            }

            _onDrawStart(e) {
                if (this.drawLocked) return;
                this.isDrawing = true;
                const rect = this.drawCanvas.getBoundingClientRect();
                const scaleX = this.drawCanvas.width / rect.width;
                const scaleY = this.drawCanvas.height / rect.height;
                const x = (e.clientX - rect.left) * scaleX;
                const y = (e.clientY - rect.top) * scaleY;
                this.drawCtx.beginPath();
                this.drawCtx.moveTo(x, y);
                this.drawCtx.lineWidth = 12;
                this.drawCtx.lineCap = 'round';
                this.drawCtx.lineJoin = 'round';
                this.drawCtx.strokeStyle = '#7c3aed';
            }

            _onDrawMove(e) {
                if (!this.isDrawing || this.drawLocked) return;
                const rect = this.drawCanvas.getBoundingClientRect();
                const scaleX = this.drawCanvas.width / rect.width;
                const scaleY = this.drawCanvas.height / rect.height;
                const x = (e.clientX - rect.left) * scaleX;
                const y = (e.clientY - rect.top) * scaleY;
                this.drawCtx.lineTo(x, y);
                this.drawCtx.stroke();
            }

            _onDrawEnd() {
                this.isDrawing = false;
            }

            _checkDrawing() {
                if (this.drawLocked) return;
                const letter = ALL_HIJAIYAH[this.drawIndex];

                // 1. Render template of the target letter
                const size = this.drawCanvas.width; // 300
                const tplCanvas = document.createElement('canvas');
                tplCanvas.width = size;
                tplCanvas.height = size;
                const tplCtx = tplCanvas.getContext('2d');
                tplCtx.fillStyle = '#ffffff';
                tplCtx.fillRect(0, 0, size, size);
                tplCtx.fillStyle = '#000000';
                tplCtx.font = `bold ${size * 0.7}px "Arial", "Noto Sans Arabic", sans-serif`;
                tplCtx.textAlign = 'center';
                tplCtx.textBaseline = 'middle';
                tplCtx.fillText(letter.arabic, size / 2, size / 2);

                // 2. Get pixel data from both canvases
                const tplData = tplCtx.getImageData(0, 0, size, size).data;
                const usrData = this.drawCtx.getImageData(0, 0, size, size).data;

                // 3. Compare: count template ink pixels and how many the user covered
                let templateInk = 0;
                let overlapInk = 0;
                let userInk = 0;
                const threshold = 200; // pixel brightness < 200 = "ink"

                for (let i = 0; i < tplData.length; i += 4) {
                    const tplBright = (tplData[i] + tplData[i + 1] + tplData[i + 2]) / 3;
                    const usrBright = (usrData[i] + usrData[i + 1] + usrData[i + 2]) / 3;
                    const tplIsInk = tplBright < threshold;
                    const usrIsInk = usrBright < threshold;

                    if (tplIsInk) templateInk++;
                    if (usrIsInk) userInk++;
                    if (tplIsInk && usrIsInk) overlapInk++;
                }

                // 4. Calculate score ‚Äî overlap relative to template, penalise excess ink
                const coverage = templateInk > 0 ? overlapInk / templateInk : 0;
                const precision = userInk > 0 ? overlapInk / userInk : 0;
                const score = (coverage * 0.7) + (precision * 0.3);

                if (score >= 0.35) {
                    // ‚úÖ CORRECT
                    this.drawLocked = true;
                    this.drawFeedback.textContent = '‚úÖ Kamu benar, ayo lanjut!';
                    this.drawFeedback.className = 'challenge-feedback correct';
                    this.soundManager.playSparkle();
                    this.soundManager.playLetterVoice(letter);

                    setTimeout(() => {
                        if (this.drawIndex < ALL_HIJAIYAH.length - 1) {
                            this._loadDrawQuestion(this.drawIndex + 1);
                        } else {
                            this._drawComplete();
                        }
                    }, 1500);
                } else {
                    // ‚ùå WRONG
                    this.drawFeedback.textContent = '‚ùå Kamu salah, ayo coba lagi!';
                    this.drawFeedback.className = 'challenge-feedback wrong';
                    this.soundManager.playBuzz();
                }
            }

            _drawComplete() {
                this.drawOverlay.classList.remove('show');
                this.drawProgressFill.style.width = '100%';

                this.celebrationText.innerHTML = 'üåü Amazing! üåü<br>You drew all 28 letters!';
                this.celebration.classList.add('show');
                this.soundManager.playCelebration();

                for (let i = 0; i < 5; i++) {
                    setTimeout(() => {
                        this.particleSystem.burst(
                            new THREE.Vector3(
                                (Math.random() - 0.5) * 4,
                                2 + Math.random() * 2,
                                (Math.random() - 0.5) * 4
                            )
                        );
                    }, i * 250);
                }

                this.drawMode = false;
            }

            // ==========================================
            // SORT MODE
            // ==========================================
            _startSort() {
                this.sortMode = true;
                this.sortedCount = 0;
                this.sortOverlay.classList.add('show');
                this.soundManager.playSparkle();
                this._renderSortUI();
                // Process tree image if not already done
                if (!this._treeProcessed) {
                    this._processTreeImage();
                }
            }

            _processTreeImage() {
                this._treeProcessed = true;
                const img = new Image();
                img.onload = () => {
                    const c = document.createElement('canvas');
                    c.width = img.naturalWidth;
                    c.height = img.naturalHeight;
                    const ctx = c.getContext('2d');
                    ctx.drawImage(img, 0, 0);
                    const imageData = ctx.getImageData(0, 0, c.width, c.height);
                    const data = imageData.data;
                    for (let i = 0; i < data.length; i += 4) {
                        const r = data[i], g = data[i + 1], b = data[i + 2];
                        const brightness = (r + g + b) / 3;
                        const saturation = Math.max(r, g, b) - Math.min(r, g, b);
                        if (brightness > 210 && saturation < 25) {
                            data[i + 3] = 0;
                        } else if (brightness > 190 && saturation < 35) {
                            const alpha = Math.max(0, Math.min(255, ((210 - brightness) / 20) * 255));
                            data[i + 3] = Math.round(alpha);
                        }
                    }
                    ctx.putImageData(imageData, 0, 0);
                    const dataUrl = c.toDataURL('image/png');
                    document.documentElement.style.setProperty('--tree-bg', `url(${dataUrl})`);
                };
                img.src = 'data:image/jpeg;base64,/9j/2wCEAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSgBBwcHCggKEwoKEygaFhooKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKP/AABEIAoACgAMBIgACEQEDEQH/xAGiAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgsQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+gEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoLEQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/APqeiiikIKKKKACilooASjFLiigBMUUtFFgEopaKAExRilooASilooATFFLRQAlGKWigBO1FLRQAlFLRQAmKKWiiwCUUtFAWEopaKAExRS0UAJijFLRQAlFLSUWAKMUtJQAUUtFACUUUtACUUUUAFFLRQAmKKWigBKKWigBAKMUtFACYoopaAsIaKWigBKMUtFACUUUtACUYpaKAEopaKAEopaKAE+lGKWigBKKWigBO1GKWkoAMUUtFACUUtAoASilpKACgiloosAlFFFABRRS0DCiiigApKWimAUlLRQAlFLRQAUUUUAJS0UUCCiiikAlLRRTGFJS0UhCUtJS0xiUUUtIBKKWkoEFFLSUxhRS0lABS0UUhBSUUUxhS0lLQIKKKKAEpaSlpDCioZ54bdd08scS+rsFH6022vLW64triCbH/ADzkDfyouK6LFJRRQAtJRRQMWiiigApKWimAlFLRSASloopiCikooGFFLRQAlLRRQIKSlooGFJQKWgAooopCCiiimAUUUUDCiiigAooooAKSiloAKKKKAEooopCCloopjCiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAo5oooAKKKKAEpaKKACiiigApKWigAooxRQAtIajuJo7eGSad1jijUu7scBQOSTXzn8QPi3qOs3M1p4dmksdLUlRMnE049c/wqewHPqe1ROaijCtXjSV5H0VNdQQkCaeKNj2dwD+tSKyuoZSCp6EHIr4fuC08pknZpZDyWkJYn8TWnoPiLWNAuFl0fUbm1IPKK+Ub6oeD+VZe28jkWYK+q0Ps6vIPit8VW0W6l0Xw40b6gny3F0RuWA/3VHQt654HuaTRvi6l/4I1e4uUjt9esbcusa/cmJIVXXPoSMr2+lfP0jNJI8kjF5HYszMcliTkk0VKmmg8Ti/dSpvcs6nfXeq3DXGpXM93OxyXncuf16fhVe2ZraUSW7NDIvIeMlGH4im0VhqeZd7nq/wAP/i9f6Xcw2XiaV73TmIX7S3MsHuT/ABr655+vSvoiCVJoklidXjcBlZTkMDyCD6V8PkZr3j4UePrLR/h5cjXJ2xpswhgUcvIrDcqKO5HzD0AFb06nRnoYTEu/LNntdL+dfMXiz4teIdZldNPmOlWRPypbn94R/tP1z9MVwk2p6hNIXlvryST+807k/wA6brLoazx8E7RVz7XzRXyDoPjrxNokqtZaxctGD/qbhvOjP4N/Qivd/hv8ULPxRImn6jGljqxHyqGzHP8A7hPQ/wCyfwzVRqp6GlLFwqO2zPSKKTtxS1odYUUUUCCiiimMKKSloAKKKKQBRRRTAKKKKACiiikAUUZopgFAoooAKKKKACiiigAooooAKKKKACkpaKAEoFFFIQtFFFABRRRTGFFFFABRRS0AGKSlooASiiigAooooAKKKWkISiiimMKKKWgBKKKKQgoorH13xLpGhAf2pfRQOeRHnc5/4COaTkkrsG0ldmxRXBj4p+GvM2mW7A/vG3OP8a6XQ/Eek64pOlX0NwwGSgOHH1U81Cqwk7JkKpCWiZr0UlLWhYUVVub+0tTi5ureE+kkir/M1Jb3MFwm63mj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';
            }

            _exitSort() {
                this.sortMode = false;
                this.sortOverlay.classList.remove('show');
                this.sortFeedback.textContent = '';
                this.sortFeedback.className = 'sort-feedback';
                this.soundManager.playClick();
                // Cleanup any drag state
                this._dragApple = null;
            }

            _renderSortUI() {
                // Shuffle all 28 letters
                const shuffled = [...ALL_HIJAIYAH].map((l, i) => ({ ...l, origIndex: i }));
                for (let i = shuffled.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
                }

                // Clear
                this.sortTargetsEl.innerHTML = '';
                this.sortGroundEl.innerHTML = '';
                this.sortFeedback.textContent = '';
                this.sortFeedback.className = 'sort-feedback';
                this._updateSortProgress();

                // Create 5 Target Trees
                const groupRanges = [
                    { label: 'Group 1', letters: 'ÿß - ÿ≠' },
                    { label: 'Group 2', letters: 'ÿÆ - ÿ≥' },
                    { label: 'Group 3', letters: 'ÿ¥ - ÿπ' },
                    { label: 'Group 4', letters: 'ÿ∫ - ŸÖ' },
                    { label: 'Group 5', letters: 'ŸÜ - Ÿä' },
                ];

                const shadowSlots = [
                    { top: '15%', left: '50%' },
                    { top: '35%', left: '20%' },
                    { top: '35%', left: '80%' },
                    { top: '55%', left: '30%' },
                    { top: '55%', left: '70%' },
                    { top: '45%', left: '50%' }
                ];

                groupRanges.forEach((gr, i) => {
                    const count = i < 4 ? 6 : 4;
                    const tree = document.createElement('div');
                    tree.className = 'sort-target-tree';
                    tree.dataset.group = i;

                    // Create canopy container for shadows
                    const canopy = document.createElement('div');
                    canopy.className = 'sort-tree-canopy';

                    const groupLetters = ALL_HIJAIYAH.slice(i * 6, (i * 6) + count);
                    groupLetters.forEach((letterObj, slotIdx) => {
                        const shadow = document.createElement('div');
                        shadow.className = 'sort-shadow-apple';
                        shadow.textContent = letterObj.arabic;
                        // Provide origIndex so we can match it when dropping
                        shadow.dataset.origIndex = i * 6 + slotIdx;

                        const pos = shadowSlots[slotIdx];
                        shadow.style.top = pos.top;
                        shadow.style.left = pos.left;

                        canopy.appendChild(shadow);
                    });

                    tree.innerHTML = `
                        <div class="sort-tree-sign">
                            <div class="sort-tree-label">${gr.label}</div>
                            <div class="sort-tree-count" id="tree-count-${i}">0/${count}</div>
                        </div>
                    `;
                    tree.appendChild(canopy);
                    this.sortTargetsEl.appendChild(tree);
                });

                // Render Legend Modal Content
                const legendBody = document.getElementById('legend-modal-body');
                if (legendBody.innerHTML === '') {
                    groupRanges.forEach((gr, i) => {
                        const letters = ALL_HIJAIYAH.slice(i * 6, (i * 6) + (i < 4 ? 6 : 4));
                        const itemsHtml = letters.map(l => `<div class="legend-item"><span class="ar">${l.arabic}</span><span class="la">(${l.name})</span></div>`).join('');
                        legendBody.innerHTML += `
                            <div class="legend-group">
                                <h3>${gr.label}</h3>
                                <div class="legend-items">${itemsHtml}</div>
                            </div>
                        `;
                    });
                }

                // Initialize batched apple dropping
                this._shuffledApples = shuffled;
                this._activeApplesCount = 0;
                this.sortedCount = 0;
                this._spawnNextApples();

                // Global move/up handlers
                this._sortMoveHandler = (e) => {
                    const ev = e.touches ? e.touches[0] : e;
                    this._onAppleDrag(ev);
                };
                this._sortEndHandler = (e) => {
                    const ev = e.changedTouches ? e.changedTouches[0] : e;
                    this._onAppleDragEnd(ev);
                };

                document.addEventListener('mousemove', this._sortMoveHandler);
                document.addEventListener('mouseup', this._sortEndHandler);
                document.addEventListener('touchmove', this._sortMoveHandler, { passive: false });
                document.addEventListener('touchend', this._sortEndHandler);
            }

            _spawnNextApples() {
                const countToSpawn = Math.min(5, this._shuffledApples.length);
                if (countToSpawn === 0) return;

                for (let i = 0; i < countToSpawn; i++) {
                    const letter = this._shuffledApples.pop();
                    const apple = document.createElement('div');
                    apple.className = 'sort-apple';
                    apple.textContent = letter.arabic;
                    apple.dataset.group = Math.floor(letter.origIndex / LETTERS_PER_GROUP);
                    apple.dataset.name = letter.name;
                    apple.dataset.origIndex = letter.origIndex;

                    // Random position on the bottom ground area (avoiding edges)
                    const leftPct = 10 + Math.random() * 80;
                    const topPct = 20 + Math.random() * 60;

                    apple.style.position = 'absolute';
                    // Start off-screen right
                    apple.style.left = `120%`;
                    apple.style.top = `calc(${topPct}% - clamp(14px, 3vw, 22px))`;

                    // Mouse drag
                    apple.addEventListener('mousedown', (e) => this._onAppleDragStart(e, apple));
                    // Touch drag
                    apple.addEventListener('touchstart', (e) => {
                        e.preventDefault();
                        this._onAppleDragStart(e.touches[0], apple);
                    }, { passive: false });

                    this.sortGroundEl.appendChild(apple);

                    // Animate falling in from the right
                    setTimeout(() => {
                        apple.style.transition = 'left 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94), top 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94)';
                        apple.style.left = `calc(${leftPct}% - clamp(14px, 3vw, 22px))`;

                        // Remove transition after landing so drag works smoothly
                        setTimeout(() => {
                            apple.style.transition = '';
                        }, 850);
                    }, i * 200); // 200ms stagger between each apple

                    this._activeApplesCount++;
                }
            }

            _onAppleDragStart(e, apple) {
                if (apple.classList.contains('sorted')) return;
                this._dragApple = apple;
                const rect = apple.getBoundingClientRect();
                this._dragOffsetX = e.clientX - rect.left - rect.width / 2;
                this._dragOffsetY = e.clientY - rect.top - rect.height / 2;
                // Save original position before dragging
                this._dragOrigLeft = apple.style.left;
                this._dragOrigTop = apple.style.top;
                apple.classList.add('dragging');
                apple.style.position = 'fixed';
                apple.style.left = (e.clientX - rect.width / 2) + 'px';
                apple.style.top = (e.clientY - rect.height / 2) + 'px';
                apple.style.margin = '0';

                // Clear any previous feedback
                this.sortFeedback.textContent = '';
                this.sortFeedback.className = 'sort-feedback';

                // Highlight trees
                this.sortTargetsEl.querySelectorAll('.sort-target-tree').forEach(b => b.classList.remove('highlight'));
            }

            _onAppleDrag(e) {
                if (!this._dragApple) return;
                if (e.cancelable !== false && e.preventDefault) e.preventDefault();
                const apple = this._dragApple;
                const w = apple.offsetWidth;
                const h = apple.offsetHeight;
                apple.style.left = (e.clientX - w / 2) + 'px';
                apple.style.top = (e.clientY - h / 2) + 'px';

                // Highlight tree under cursor
                const trees = this.sortTargetsEl.querySelectorAll('.sort-target-tree');
                trees.forEach(t => {
                    const br = t.getBoundingClientRect();
                    const over = e.clientX >= br.left && e.clientX <= br.right && e.clientY >= br.top && e.clientY <= br.bottom;
                    t.classList.toggle('highlight', over);
                });
            }

            _onAppleDragEnd(e) {
                if (!this._dragApple) return;
                const apple = this._dragApple;
                this._dragApple = null;
                apple.classList.remove('dragging');

                // Find which tree we dropped on
                const trees = this.sortTargetsEl.querySelectorAll('.sort-target-tree');
                let droppedTree = null;
                trees.forEach(t => {
                    t.classList.remove('highlight');
                    const br = t.getBoundingClientRect();
                    if (e.clientX >= br.left && e.clientX <= br.right && e.clientY >= br.top && e.clientY <= br.bottom) {
                        droppedTree = t;
                    }
                });

                if (droppedTree) {
                    const appleGroup = parseInt(apple.dataset.group);
                    const treeGroup = parseInt(droppedTree.dataset.group);

                    if (appleGroup === treeGroup) {
                        // ‚úÖ Correct tree!
                        apple.classList.add('sorted');
                        // Find corresponding shadow slot
                        const origIndex = apple.dataset.origIndex;
                        const shadow = droppedTree.querySelector(`.sort-shadow-apple[data-orig-index="${origIndex}"]`);

                        if (shadow) {
                            const rect = shadow.getBoundingClientRect();
                            apple.style.left = rect.left + 'px';
                            apple.style.top = rect.top + 'px';

                            // Highlight the shadow briefly to show successful match
                            shadow.style.background = 'rgba(52, 211, 153, 0.6)';
                            shadow.style.borderColor = 'rgba(52, 211, 153, 1)';
                        } else {
                            // visually move apple to tree canopy before disappearing
                            apple.style.left = (droppedTree.getBoundingClientRect().left + droppedTree.offsetWidth / 2 - apple.offsetWidth / 2) + 'px';
                            apple.style.top = (droppedTree.getBoundingClientRect().top + droppedTree.offsetHeight / 3) + 'px';
                        }

                        this.sortedCount++;
                        this._activeApplesCount--;
                        this._updateSortProgress();

                        // Update tree count
                        const maxCount = treeGroup < 4 ? 6 : 4;
                        const countEl = document.getElementById(`tree-count-${treeGroup}`);
                        const currentCount = parseInt(countEl.textContent.split('/')[0]) + 1;
                        countEl.textContent = `${currentCount}/${maxCount}`;

                        this.sortFeedback.textContent = `‚úÖ Benar! ${apple.dataset.name} masuk Pohon Grup ${treeGroup + 1}!`;
                        this.sortFeedback.className = 'sort-feedback correct';
                        this.soundManager.playSparkle();

                        // Play letter voice
                        const letter = ALL_HIJAIYAH[parseInt(apple.dataset.origIndex)];
                        if (this.soundManager._isIOS) {
                            this.soundManager.playLetterVoice(letter);
                        } else {
                            setTimeout(() => this.soundManager.playLetterVoice(letter), 200);
                        }

                        // Check completion or spawn next batch
                        if (this.sortedCount >= ALL_HIJAIYAH.length) {
                            setTimeout(() => this._sortComplete(), 800);
                        } else if (this._activeApplesCount <= 0) {
                            setTimeout(() => this._spawnNextApples(), 800);
                        }
                    } else {
                        // ‚ùå Wrong tree ‚Äî return apple to original position
                        this.sortFeedback.textContent = 'üçé Buah ini bukan di pohon yang tepat!';
                        this.sortFeedback.className = 'sort-feedback wrong';
                        this.soundManager.playBuzz();

                        // Restore to original tree position
                        apple.style.position = 'absolute';
                        apple.style.left = this._dragOrigLeft;
                        apple.style.top = this._dragOrigTop;
                        apple.style.margin = '';
                        apple.style.animation = 'apple-bounce 0.4s ease';
                        setTimeout(() => apple.style.animation = '', 400);
                    }
                } else {
                    // Dropped outside any tree ‚Äî return to tree
                    apple.style.position = 'absolute';
                    apple.style.left = this._dragOrigLeft;
                    apple.style.top = this._dragOrigTop;
                    apple.style.margin = '';
                }
            }

            _updateSortProgress() {
                this.sortProgress.textContent = `${this.sortedCount} / ${ALL_HIJAIYAH.length}`;
                this.sortProgressFill.style.width = `${(this.sortedCount / ALL_HIJAIYAH.length) * 100}%`;
            }

            _sortComplete() {
                // Remove global handlers
                document.removeEventListener('mousemove', this._sortMoveHandler);
                document.removeEventListener('mouseup', this._sortEndHandler);
                document.removeEventListener('touchmove', this._sortMoveHandler);
                document.removeEventListener('touchend', this._sortEndHandler);

                this.sortOverlay.classList.remove('show');
                this.sortProgressFill.style.width = '100%';

                this.celebrationText.innerHTML = 'üåü Amazing! üåü<br>You sorted all 28 letters!';
                this.celebration.classList.add('show');
                this.soundManager.playCelebration();

                for (let i = 0; i < 5; i++) {
                    setTimeout(() => {
                        this.particleSystem.burst(
                            new THREE.Vector3(
                                (Math.random() - 0.5) * 4,
                                2 + Math.random() * 2,
                                (Math.random() - 0.5) * 4
                            )
                        );
                    }, i * 250);
                }

                this.sortMode = false;
            }

            _onResize() {
                const w = window.innerWidth;
                const h = window.innerHeight;
                this.camera.aspect = w / h;
                this.camera.updateProjectionMatrix();
                this.renderer.setSize(w, h);
                this.renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
            }

            _animate() {
                requestAnimationFrame(() => this._animate());
                this.controls.update();
                this.renderer.render(this.scene, this.camera);
            }

            dispose() {
                this.cube.dispose();
                this.particleSystem.dispose();
                this.soundManager.dispose();

                // Ground
                this.ground.geometry.dispose();
                this.ground.material.map.dispose();
                this.ground.material.dispose();

                this.renderer.dispose();
                this.controls.dispose();

                window.removeEventListener('resize', this._onResize);
            }
        }

        // ==========================================
        // ENTRY POINT
        // ==========================================
        const game = new Game();

        // Expose for debugging / cleanup
        window.__game = game;
    </script>
</body>

</html>